(function(e){function t(t){for(var r,n,o=t[0],l=t[1],c=t[2],d=0,m=[];d<o.length;d++)n=o[d],a[n]&&m.push(a[n][0]),a[n]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(m.length)m.shift()();return i.push.apply(i,c||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],r=!0,o=1;o<s.length;o++){var l=s[o];0!==a[l]&&(r=!1)}r&&(i.splice(t--,1),e=n(n.s=s[0]))}return e}var r={},a={index:0},i=[];function n(t){if(r[t])return r[t].exports;var s=r[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=r,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(s,r,function(t){return e[t]}.bind(null,r));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/assets/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;i.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"56d7":function(e,t,s){"use strict";s.r(t);s("cadf"),s("551c"),s("f751"),s("097d");var r=s("2b0e"),a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("div",{attrs:{id:"header"}},[s("HeaderApp"),s("AppNotify")],1),s("transition",[s("keep-alive",[s("router-view")],1)],1)],1)},i=[],n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"header-container container-fluid"},[s("div",{staticClass:"row"},[e._m(0),s("div",{staticClass:"col user-panel"},[e.userConnected?e._e():s("button",{staticClass:"button red",on:{click:function(t){return e.toggleConnectionModal()}}},[e._v("Se connecter/S'inscrire")]),e.userConnected?s("div",{staticClass:"user-menu"},[s("button",{staticClass:"toggle-user-menu",class:[e.showUserMenu?"opened":"closed"],on:{click:e.toggleUserMenu}},[s("span",{staticClass:"label"},[e._v(e._s(e.userInfos.email))]),s("span",{staticClass:"icon"})]),s("div",{staticClass:"user-submenu",class:[e.showUserMenu?"visible":"hidden"]},[e._m(1),e._m(2)])]):e._e()])])])},o=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col logo-container"},[s("a",{attrs:{href:"/"}},[s("img",{attrs:{id:"wakemeup-logo",src:"/assets/img/wakemeup-logo.svg",alt:"Wake Me Up"}})]),s("img",{attrs:{id:"linagora-labs-logo",src:"/assets/img/linagora-labs.png",alt:"Linagora Labs"}})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a",{staticClass:"user-submenu-link",attrs:{href:"/interface/account"}},[s("span",{staticClass:"icon user"}),s("span",{staticClass:"label user"},[e._v("Mon compte")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a",{staticClass:"user-submenu-link logout",attrs:{href:"/logout"}},[s("span",{staticClass:"icon logout"}),s("span",{staticClass:"label logout"},[e._v("Déconnexion")])])}],l=(s("28a5"),s("bc3a")),c=s.n(l),u={data:function(){return{userConnected:!1,showUserMenu:!1}},created:function(){var e=this,t=this.getCookie("wmu_user");"disconnected"!==t&&this.$store.dispatch("getUserInfos",t).then(function(t){t&&(e.userConnected=!0)},function(e){console.error("error:",err)})},computed:{userInfos:function(){return this.$store.state.userInfos}},methods:{toggleConnectionModal:function(){le.$emit("toggle_connection_modal",{})},toggleUserMenu:function(){this.showUserMenu=!this.showUserMenu},getCookie:function(e){for(var t=e+"=",s=document.cookie.split(";"),r=0;r<s.length;r++){var a=s[r];while(" "==a.charAt(0))a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return""}}},d=u,m=s("2877"),h=Object(m["a"])(d,n,o,!1,null,null,null),v=h.exports,p=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{style:e.notifHeight,attrs:{id:"notifyApp"}},[s("div",{class:e.status,attrs:{id:"notif-container"}},[s("span",{staticClass:"notif-line"}),s("span",{staticClass:"icon"}),s("span",{staticClass:"label"},[e._v(e._s(e.msg))])])])},f=[],g=(s("96cf"),s("3b8d")),w={data:function(){return{msg:"",status:"",redirect:"",notifHeight:"height: 0px;"}},mounted:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:le.$on("notify_app",function(e){t.msg=e.msg,t.status=e.status,t.redirect=e.redirect,t.redirect&&(t.msg+=" You will be redirected in 3sec..."),setTimeout(function(){var e=document.getElementById("notif-container").offsetHeight;t.notifHeight="height: "+(e+10)+"px"},200),setTimeout(function(){t.notifHeight="height: 0px;",t.redirect&&(document.location.href=t.redirect)},4e3)});case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},C=w,b=Object(m["a"])(C,p,f,!1,null,null,null),_=b.exports,E={data:function(){return{}},components:{HeaderApp:v,AppNotify:_}},P=E,M=Object(m["a"])(P,a,i,!1,null,null,null),y=M.exports,V=s("8c4f"),x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e._m(0),s("ConnectionModal"),s("CreateAccountModal")],1)},k=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"page-content"}},[s("div",{attrs:{id:"home"}},[s("div",{staticClass:"container-fluid",attrs:{id:"highlight"}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col talk"},[s("h2",[e._v("Enregistrez votre voix")]),s("div",{staticClass:"title-icon"},[s("img",{attrs:{src:"/assets/img/talk.svg",alt:"Parler"}})]),s("div",{staticClass:"highlight-content"},[e._v("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam euismod malesuada nisl, sit amet vulputate justo interdum nec. Donec lobortis, ipsum vitae hendrerit sodales, purus risus fringilla ante, eu auctor mi velit ut turpis.")]),s("div",{staticClass:"highlight-action"},[s("a",{staticClass:"button red",attrs:{href:"/interface/record"}},[e._v("Enregistrez votre voix")])])]),s("div",{staticClass:"col listen"},[s("h2",[e._v("Écoutez et participez à la validation")]),s("div",{staticClass:"title-icon"},[s("img",{attrs:{src:"/assets/img/listen.svg",alt:"Ecouter"}})]),s("div",{staticClass:"highlight-content"},[e._v("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam euismod malesuada nisl, sit amet vulputate justo interdum nec. Donec lobortis, ipsum vitae hendrerit sodales, purus risus fringilla ante, eu auctor mi velit ut turpis.")]),s("div",{staticClass:"highlight-action"},[s("button",{staticClass:"button green"},[e._v("Écouter des enregistrements")])])])])]),s("div",{staticClass:"divider red shadowTop"})])])}],N=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"modal",class:[e.showConnectionModal?"visible":"hidden"]},[s("div",{staticClass:"modal-container"},[s("div",{staticClass:"modal-header"},[s("h3",{staticClass:"modal-title red"},[e._v("Se connecter")]),s("button",{staticClass:"close-modal",on:{click:e.closeModal}})]),s("div",{staticClass:"modal-body"},[s("span",[e._v("Veuillez renseigner vos identifiants")]),s("div",{staticClass:"field-container"},[e._m(0),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userEmail,expression:"userEmail"}],staticClass:"input",class:["error"===e.userEmailValid?"error":"","valid"===e.userEmailValid?"valid":""],attrs:{type:"text"},domProps:{value:e.userEmail},on:{input:function(t){t.target.composing||(e.userEmail=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.userEmailErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userEmailErrorMsg))])]),s("div",{staticClass:"field-container"},[e._m(1),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userPswd,expression:"userPswd"}],staticClass:"input",class:["error"===e.userPswdValid?"error":"","valid"===e.userPswdValid?"valid":""],attrs:{type:"password"},domProps:{value:e.userPswd},on:{input:function(t){t.target.composing||(e.userPswd=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.userPswdErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userPswdErrorMsg))])]),s("div",{staticClass:"field-container btn"},[s("button",{staticClass:"button red large",on:{click:function(t){return e.sendLogin()}}},[e._v("S'identifier")])]),s("button",{staticClass:"aslink"},[e._v("Identifiants oubliés ?")]),s("div",{staticClass:"spacer"}),s("div",{staticClass:"divider red"}),s("div",{staticClass:"spacer"}),s("span",[e._v("Vous n'avez pas d'identifiants ?")]),s("div",{staticClass:"field-container btn"},[s("button",{staticClass:"button green large",on:{click:e.toggleCreateAccountModal}},[e._v("Créer un compte")])])])])])])},A=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label"},[s("span",{staticClass:"icon user"}),s("span",{staticClass:"label"},[e._v("Adresse email:")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label"},[s("span",{staticClass:"icon pswd"}),s("span",{staticClass:"label"},[e._v("Mot de passe :")])])}],I={data:function(){return{showConnectionModal:!1,userEmail:"rlopez@linagora.com",userEmailValid:!1,userEmailErrorMsg:"",userPswd:"admin",userPswdValid:!1,userPswdErrorMsg:""}},mounted:function(){var e=this;le.$on("toggle_connection_modal",function(){e.toggleConnectionModal()})},methods:{toggleConnectionModal:function(){this.showConnectionModal=!this.showConnectionModal},closeModal:function(){this.showConnectionModal=!1},toggleCreateAccountModal:function(){this.showConnectionModal=!1,le.$emit("toggle_create_account_modal",{})},validateEmail:function(e){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)},checkForm:function(){return 0===this.userEmail.length?(this.userEmailValid="error",this.userEmailErrorMsg="Vous devez renseigner une adresse email de connection"):this.validateEmail(this.userEmail)?(this.userEmailValid="valid",this.userEmailErrorMsg=""):(this.userEmailValid="error",this.userEmailErrorMsg="Le format de l'adresse email est invalide"),0===this.userPswd.length?(this.userPswdValid="error",this.userPswdErrorMsg="Veuillez renseigner un mot de passe"):(this.userPswdValid="valid",this.userPswdErrorMsg=""),"valid"===this.userEmailValid&&"valid"===this.userPswdValid},sendLogin:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t,s,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.checkForm(),!t){e.next=9;break}return s={email:this.userEmail,password:this.userPswd},e.next=5,c()("http://localhost:3003/login/userAuth",{method:"post",data:s});case 5:r=e.sent,"error"===r.data.status?"user"===r.data.field?(this.userEmailValid="error",this.userEmailErrorMsg=r.data.msg):"password"===r.data.field&&(this.userPswdValid="error",this.userPswdErrorMsg=r.data.msg):"success"===r.data.status&&(document.location.href="/"),e.next=10;break;case 9:return e.abrupt("return");case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},R=I,S=Object(m["a"])(R,N,A,!1,null,null,null),$=S.exports,O=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"modal",class:[e.showCreateAccountModal?"visible":"hidden"]},[s("div",{staticClass:"modal-container"},[s("div",{staticClass:"modal-header"},[s("h3",{staticClass:"modal-title green"},[e._v("Créer un compte")]),s("button",{staticClass:"close-modal",on:{click:function(t){return e.closeModal()}}}),s("button",{staticClass:"back-login-modal",on:{click:function(t){return e.backToLogin()}}})]),s("div",{staticClass:"modal-body"},[s("div",{staticClass:"field-container"},[e._m(0),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userEmail,expression:"userEmail"}],staticClass:"input",class:["error"===e.userEmailValid?"error":"","valid"===e.userEmailValid?"valid":""],attrs:{type:"text"},domProps:{value:e.userEmail},on:{input:function(t){t.target.composing||(e.userEmail=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.userEmailErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userEmailErrorMsg))])]),s("div",{staticClass:"field-container"},[e._m(1),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userPswd,expression:"userPswd"}],staticClass:"input",class:["error"===e.userPswdValid?"error":"","valid"===e.userPswdValid?"valid":""],attrs:{type:"password"},domProps:{value:e.userPswd},on:{input:function(t){t.target.composing||(e.userPswd=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.userPswdErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userPswdErrorMsg))])]),s("div",{staticClass:"field-container"},[e._m(2),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userPswdConfirm,expression:"userPswdConfirm"}],staticClass:"input",class:["error"===e.userPswdConfirmValid?"error":"","valid"===e.userPswdConfirmValid?"valid":""],attrs:{type:"password"},domProps:{value:e.userPswdConfirm},on:{input:function(t){t.target.composing||(e.userPswdConfirm=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.userPswdConfirmdErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userPswdConfirmdErrorMsg))])]),s("div",{staticClass:"field-container"},[s("div",{staticClass:"field-label"},[s("span",{staticClass:"required"},[e._v("*")]),s("span",{staticClass:"label"},[e._v("Sexe :")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.userGender,expression:"userGender"}],staticClass:"select",class:["error"===e.userGenderValid?"error":"","valid"===e.userGenderValid?"valid":""],on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.userGender=t.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"",hidden:""}},[e._v("Sélectionner un sexe")]),s("option",{attrs:{value:"male"}},[e._v("Homme")]),s("option",{attrs:{value:"female"}},[e._v("Femme")])])]),s("span",{staticClass:"error-field",class:[e.userGenderErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userGenderErrorMsg))])]),s("div",{staticClass:"field-container"},[e._m(3),s("div",{staticClass:"micro-type-container"},[s("div",{staticClass:"micro-type-item",class:["default"==e.deviceType?"active":""],on:{click:function(t){return e.setMicrophone("default")}}},[s("span",{staticClass:"icon default"}),s("span",{staticClass:"label"},[e._v("Micro par défaut")])]),s("div",{staticClass:"micro-type-item",class:["casque"==e.deviceType?"active":""],on:{click:function(t){return e.setMicrophone("casque")}}},[s("span",{staticClass:"icon casque"}),s("span",{staticClass:"label"},[e._v("Micro-casque")])]),s("div",{staticClass:"micro-type-item",class:["pied"==e.deviceType?"active":""],on:{click:function(t){return e.setMicrophone("pied")}}},[s("span",{staticClass:"icon pied"}),s("span",{staticClass:"label"},[e._v("Micro à pied")])])])]),s("div",{staticClass:"field-container btn"},[s("button",{staticClass:"button green large",on:{click:function(t){return e.sendForm()}}},[e._v(e._s(e.btnCreateAccountLabel))]),s("span",{staticClass:"status-field",class:[e.createAccountStatus.length>0?"visible "+e.createAccountStatus:"hidden"]},[e._v(e._s(e.createAccoutMsg))])])])])])])},U=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label"},[s("span",{staticClass:"required"},[e._v("*")]),s("span",{staticClass:"label"},[e._v("Adresse email:")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label"},[s("span",{staticClass:"required"},[e._v("*")]),s("span",{staticClass:"label"},[e._v("Mot de passe :")]),s("button",{staticClass:"info-label"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label"},[s("span",{staticClass:"required"},[e._v("*")]),s("span",{staticClass:"label"},[e._v("Confirmation du mot de passe :")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label"},[s("span",{staticClass:"required"},[e._v("*")]),s("span",{staticClass:"label"},[e._v("Type de mircophone :")])])}],T={data:function(){return{showCreateAccountModal:!1,deviceType:"default",userEmail:"",userEmailValid:!1,userEmailErrorMsg:"",userPswd:"",userPswdValid:!1,userPswdErrorMsg:"",userPswdConfirm:"",userPswdConfirmValid:!1,userPswdConfirmdErrorMsg:"",userGender:"",userGenderValid:!1,userGenderErrorMsg:"",btnCreateAccountLabel:"Créer un compte",createAccountStatus:"",createAccoutMsg:""}},mounted:function(){var e=this;le.$on("toggle_create_account_modal",function(){e.showCreateAccountModal=!0})},methods:{setMicrophone:function(e){this.deviceType=e},closeModal:function(){this.showCreateAccountModal=!1},backToLogin:function(){this.showCreateAccountModal=!1,le.$emit("toggle_connection_modal",function(){})},validateEmail:function(e){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)},sendForm:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t,s,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.checkForm(),!t){e.next=12;break}return this.btnCreateAccountLabel="Création en cours...",s={email:this.userEmail,pswd:this.userPswd,gender:this.userGender,deviceType:this.deviceType},e.next=6,c()("http://localhost:3003/login/createUser",{method:"post",data:s});case 6:r=e.sent,this.createAccountStatus=r.data.status,this.createAccoutMsg=r.data.msg,"success"===r.data.status?(this.btnCreateAccountLabel="Succès",this.createAccoutMsg+=", vous allez être redirigé dans 3 sec",this.setCookie("wmu_user",r.data.userHash),setTimeout(function(){document.location.href="/"},3e3)):this.btnCreateAccountLabel="Créer un compte",e.next=13;break;case 12:return e.abrupt("return");case 13:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),checkForm:function(){return 0===this.userEmail.length?(this.userEmailValid="error",this.userEmailErrorMsg="Veuillez renseigner une adresse email"):this.validateEmail(this.userEmail)?(this.userEmailValid="valid",this.userEmailErrorMsg=""):(this.userEmailValid="error",this.userEmailErrorMsg="Le format de l'adresse email est invalide"),0===this.userPswd.length?(this.userPswdValid="error",this.userPswdErrorMsg="Veuillez renseigner un mot de passe"):this.userPswd.length<8?(this.userPswdValid="error",this.userPswdErrorMsg="Le mot de passe doit contenir au moins 8 caractères"):(this.userPswdValid="valid",this.userPswdErrorMsg=""),0===this.userPswdConfirm.length?this.userPswdConfirmValid="error":this.userPswdConfirm!==this.userPswd?(this.userPswdConfirmValid="error",this.userPswdConfirmdErrorMsg="Les mots de passes doivent êtres identiques"):(this.userPswdConfirmValid="valid",this.userPswdConfirmdErrorMsg=""),""===this.userGender?(this.userGenderValid="error",this.userGenderErrorMsg="Veuillez sélectionner un sexe"):(this.userGenderValid="valid",this.userGenderErrorMsg=""),"valid"===this.userEmailValid&&"valid"===this.userPswdValid&&"valid"===this.userPswdConfirmValid&&"valid"===this.userGenderValid},setCookie:function(e,t,s){var r=new Date;r.setTime(r.getTime()+24*s*60*60);var a="expires="+r.toUTCString();document.cookie=e+"="+t+";"+a+";path=/"},getCookie:function(e){for(var t=e+"=",s=document.cookie.split(";"),r=0;r<s.length;r++){var a=s[r];while(" "==a.charAt(0))a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return""}}},L=T,j=Object(m["a"])(L,O,U,!1,null,null,null),z=j.exports,B={data:function(){return{showConnectModal:!1}},components:{Header:v,ConnectionModal:$,CreateAccountModal:z}},F=B,H=Object(m["a"])(F,x,k,!1,null,null,null),G=H.exports,q=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"page-content"}},[s("button",{staticClass:"button",attrs:{id:"start"},on:{click:function(t){return e.startRecording()}}},[e._v("Start recording")]),s("button",{staticClass:"button",attrs:{id:"stop"},on:{click:function(t){return e.stopRecording()}}},[e._v("Stop recording")]),s("button",{staticClass:"button",on:{click:function(t){return e.playRecord()}}},[e._v("Play")]),s("button",{staticClass:"button",on:{click:function(t){return e.test()}}},[e._v("TEST")])])},D=[],W=s("f499"),J=s.n(W),Z=(s("63d9"),{data:function(){return{context:null,analyser:null,blob:null,leftchannel:[],rightchannel:[],leftBuffer:"",rightBufffer:"",recorder:null,recordingLength:0,volume:null,mediaStream:null,sampleRate:44100,mediaRecorder:null,mediaRecorderblob:null,mediaRecorderChunk:[],bufferSize:4096,numberOfInputChannels:2,numberOfOutputChannels:2,buffer:null,view:null,sourceNode:null}},mounted:function(){var e=this;navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:{channelCount:{min:1,ideal:2}}}).then(function(t){document.getElementById("start"),document.getElementById("stop");window.AudioContext=window.AudioContext||window.webkitAudioContext,e.context=new AudioContext,e.mediaStream=e.context.createMediaStreamSource(t),e.analyser=e.context.createAnalyser(),e.mediaRecorder=new MediaRecorder(t),e.context.createScriptProcessor?e.recorder=e.context.createScriptProcessor(e.bufferSize,e.numberOfInputChannels,e.numberOfOutputChannels):e.recorder=e.context.createJavaScriptNode(e.bufferSize,e.numberOfInputChannels,e.numberOfOutputChannels),e.mediaRecorderChunk=[],e.mediaRecorder.ondataavailable=function(t){e.mediaRecorderChunk.push(t.data),e.mediaRecorderblob=new Blob(mediaRecorderChunk,{type:"audio/webm; codecs=opus"}),console.log("MR Blob :",e.mediaRecorderblob)},e.recorder.onaudioprocess=function(t){e.leftchannel.push(new Float32Array(t.inputBuffer.getChannelData(0))),e.rightchannel.push(new Float32Array(t.inputBuffer.getChannelData(1))),e.recordingLength+=e.bufferSize}}).catch(function(e){console.error(e)}):console.log("no userMEdia")},methods:{startRecording:function(){this.mediaStream.connect(this.recorder),this.recorder.connect(this.context.destination)},stopRecording:function(){var e=new Audio(i);this.recorder.disconnect(this.context.destination),this.mediaStream.disconnect(this.recorder),this.sourceNode=this.context.createMediaElementSource(e),this.sourceNode.connect(this.context.destination),this.leftBuffer=this.flattenArray(this.leftchannel,this.recordingLength),this.rightBuffer=this.flattenArray(this.rightchannel,this.recordingLength);var t=this.interleave(this.leftBuffer,this.rightBuffer);this.buffer=new ArrayBuffer(44+2*t.length),this.view=new DataView(this.buffer),this.writeUTFBytes(this.view,0,"RIFF"),this.view.setUint32(4,44+2*t.length,!0),this.writeUTFBytes(this.view,8,"WAVE"),this.writeUTFBytes(this.view,12,"fmt "),this.view.setUint32(16,16,!0),this.view.setUint16(20,1,!0),this.view.setUint16(22,2,!0),this.view.setUint32(24,this.sampleRate,!0),this.view.setUint32(28,4*this.sampleRate,!0),this.view.setUint16(32,4,!0),this.view.setUint16(34,16,!0),this.writeUTFBytes(this.view,36,"data"),this.view.setUint32(40,2*t.length,!0);for(var s=44,r=1,a=0;a<t.length;a++)this.view.setInt16(s,t[a]*(32767*r),!0),s+=2;this.blob=new Blob([this.view],{type:"audio/wav"});this.analyser.context.sampleRate,this.analyser.channelCount,this.analyser.numberOfInputs,this.analyser.numberOfOutputs,this.recorder.bufferSize;var i=window.URL.createObjectURL(this.blob);e.play(),console.log("Blob: ",this.blob)},playRecord:function(){if(null!=this.blob){var e=window.URL.createObjectURL(this.blob),t=new Audio(e);t.play()}},flattenArray:function(e,t){for(var s=new Float32Array(t),r=0,a=0;a<e.length;a++){var i=e[a];s.set(i,r),r+=i.length}return s},interleave:function(e,t){for(var s=e.length+t.length,r=new Float32Array(s),a=0,i=0;i<s;)r[i++]=e[a],r[i++]=t[a],a++;return r},writeUTFBytes:function(e,t,s){for(var r=0;r<s.length;r++)e.setUint8(t+r,s.charCodeAt(r))},sendDatas:function(e,t,s){var r=new FormData;r.append("webAudioInfos",J()(t)),r.append(s,e,s);var a=new XMLHttpRequest;a.open("POST","http://localhost:3003/saveaudio"),a.send(r)},test:function(){console.log(this.leftchannel,this.rightchannel)}}}),X=Z,Y=Object(m["a"])(X,q,D,!1,null,null,null),K=Y.exports,Q=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{attrs:{id:"page-content"}},[s("div",{staticClass:"container-fluid"},[s("div",{staticClass:"row justify-content-around"},[s("div",{staticClass:"col-5"},[s("h2",[e._v("Informations utilisateur")]),s("div",{staticClass:"white-container"},[s("table",{staticClass:"user-panel-tab"},[s("tbody",[s("tr",[s("td",{staticClass:"tab-label"},[e._v("Adresse email :")]),s("td",{staticClass:"tab-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userEmail,expression:"userEmail"}],staticClass:"input",class:["error"===e.userEmailValid?"error":"","valid"===e.userEmailValid?"valid":""],domProps:{value:e.userEmail},on:{input:function(t){t.target.composing||(e.userEmail=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.userEmailErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userEmailErrorMsg))])])]),s("tr",[s("td",{staticClass:"tab-label"},[e._v("Sexe :")]),s("td",{staticClass:"tab-input"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.userInfos.gender,expression:"userInfos.gender"}],staticClass:"select",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.userInfos,"gender",t.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"male"}},[e._v("Homme")]),s("option",{attrs:{value:"female"}},[e._v("Femme")])])])]),s("tr",[s("td",{staticClass:"tab-label"},[e._v("Type de microphone :")]),s("td",{staticClass:"tab-input"},[s("div",{staticClass:"micro-type-container"},[s("div",{staticClass:"micro-type-item",class:["default"===e.userInfos.deviceType?"active":""],on:{click:function(t){return e.setMicrophone("default")}}},[s("span",{staticClass:"icon default"}),s("span",{staticClass:"label"},[e._v("Micro par défaut")])]),s("div",{staticClass:"micro-type-item",class:["casque"===e.userInfos.deviceType?"active":""],on:{click:function(t){return e.setMicrophone("casque")}}},[s("span",{staticClass:"icon casque"}),s("span",{staticClass:"label"},[e._v("Micro-casque")])]),s("div",{staticClass:"micro-type-item",class:["pied"===e.userInfos.deviceType?"active":""],on:{click:function(t){return e.setMicrophone("pied")}}},[s("span",{staticClass:"icon pied"}),s("span",{staticClass:"label"},[e._v("Micro à pied")])])])])])])]),s("div",{staticClass:"spacer"}),s("div",{staticClass:"divider grey"}),s("div",{staticClass:"spacer"}),s("span",{staticClass:"info"},[e._v("Les informations suivantes sont facultatives")]),s("table",{staticClass:"user-panel-tab"},[s("tbody",[s("tr",[s("td",{staticClass:"tab-label"},[e._v("Nom :")]),s("td",{staticClass:"tab-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfos.lastName,expression:"userInfos.lastName"}],staticClass:"input",class:["error"===e.lastNameValid?"error":"","valid"===e.lastNameValid?"valid":""],domProps:{value:e.userInfos.lastName},on:{input:function(t){t.target.composing||e.$set(e.userInfos,"lastName",t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.lastNameErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.lastNameErrorMsg))])])]),s("tr",[s("td",{staticClass:"tab-label"},[e._v("Prénom :")]),s("td",{staticClass:"tab-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfos.firstName,expression:"userInfos.firstName"}],staticClass:"input",class:["error"===e.firstNameValid?"error":"","valid"===e.firstNameValid?"valid":""],domProps:{value:e.userInfos.firstName},on:{input:function(t){t.target.composing||e.$set(e.userInfos,"firstName",t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.firstNameErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.firstNameErrorMsg))])])]),s("tr",[s("td",{staticClass:"tab-label"},[e._v("Tranche d'âge :")]),s("td",{staticClass:"tab-input"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.userInfos.ageRange,expression:"userInfos.ageRange"}],staticClass:"select",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.userInfos,"ageRange",t.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"",hidden:""}},[e._v("Sélectionner votre tranche d'âge")]),s("option",{attrs:{value:"10-20"}},[e._v("10 - 20 ans")]),s("option",{attrs:{value:"20-30"}},[e._v("20 - 30 ans")]),s("option",{attrs:{value:"30-40"}},[e._v("30 - 40 ans")]),s("option",{attrs:{value:"40-50"}},[e._v("40 - 50 ans")]),s("option",{attrs:{value:"50-60"}},[e._v("50 - 60 ans")]),s("option",{attrs:{value:"60-70"}},[e._v("60 - 70 ans")]),s("option",{attrs:{value:"70+"}},[e._v("70+ ans")])])])]),s("tr",[s("td",{staticStyle:{"padding-top":"10px"},attrs:{colspan:"2"}},[s("button",{staticClass:"button green large",on:{click:function(t){return e.updateProfil()}}},[e._v("Mettre mes informations à jour")])])])])])]),s("h2",[e._v("Modifier le mot de passe")]),s("div",{staticClass:"white-container"},[s("table",{staticClass:"user-panel-tab"},[s("tbody",[s("tr",[s("td",{staticClass:"tab-label"},[e._v("Mot de passe actuel :")]),s("td",{staticClass:"tab-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.currentPswd,expression:"currentPswd"}],staticClass:"input",class:["error"===e.currentPswdValid?"error":"","valid"===e.currentPswdValid?"valid":""],attrs:{type:"password"},domProps:{value:e.currentPswd},on:{input:function(t){t.target.composing||(e.currentPswd=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.currentPswdErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.currentPswdErrorMsg))])])]),s("tr",[s("td",{staticClass:"tab-label"},[e._v("Nouveau mot de passe :")]),s("td",{staticClass:"tab-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newPswd,expression:"newPswd"}],staticClass:"input",class:["error"===e.newPswdValid?"error":"","valid"===e.newPswdValid?"valid":""],attrs:{type:"password"},domProps:{value:e.newPswd},on:{input:function(t){t.target.composing||(e.newPswd=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.newPswdErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.newPswdErrorMsg))])])]),s("tr",[s("td",{staticClass:"tab-label"},[e._v("Confirmation du ouveau mot de passe :")]),s("td",{staticClass:"tab-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newPswdConfirm,expression:"newPswdConfirm"}],staticClass:"input",class:["error"===e.newPswdConfirmValid?"error":"","valid"===e.newPswdConfirmValid?"valid":""],attrs:{type:"password"},domProps:{value:e.newPswdConfirm},on:{input:function(t){t.target.composing||(e.newPswdConfirm=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.newPswdConfirmErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.newPswdConfirmErrorMsg))])])]),s("tr",[s("td",{staticStyle:{"padding-top":"10px"},attrs:{colspan:"2"}},[s("button",{staticClass:"button red large",on:{click:function(t){return e.updatePswd()}}},[e._v("Modifier le mot de passe")])])])])])])]),s("div",{staticClass:"col-5"},[s("h2",[e._v("Statistiques")]),s("div",{staticClass:"white-container"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col user-stats"},[s("h3",[e._v("Wake-words enregistrés")]),s("div",{staticClass:"stats-container"},[s("span",{staticClass:"icon talk"}),s("span",{staticClass:"number talk"},[e._v(e._s(e.userInfos.nbRecord))])]),s("button",{staticClass:"button red"},[e._v("S'enregistrer")])]),s("div",{staticClass:"col user-stats"},[s("h3",[e._v("Wake-words écoutés")]),s("div",{staticClass:"stats-container"},[s("span",{staticClass:"icon listen"}),s("span",{staticClass:"number listen"},[e._v(e._s(e.userInfos.nbListen))])]),s("button",{staticClass:"button green"},[e._v("Écouter")])])])])])])])])])},ee=[],te={data:function(){return{userEmail:"",userEmailValid:!1,userEmailErrorMsg:"",lastNameValid:!1,lastNameErrorMsg:"",firstNameValid:!1,firstNameErrorMsg:"",currentPswd:"",currentPswdValid:!1,currentPswdErrorMsg:"",newPswd:"",newPswdValid:!1,newPswdErrorMsg:"",newPswdConfirm:"",newPswdConfirmValid:!1,newPswdConfirmErrorMsg:""}},computed:{userInfos:function(){return this.userEmail=this.$store.state.userInfos.email,this.$store.state.userInfos}},methods:{setMicrophone:function(e){this.userInfos.deviceType=e},validateEmail:function(e){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)},validateNames:function(e){return/^[a-zA-Z]+(([',. -][a-zA-Z ])?[a-zA-Z]*)*$/.test(e)},checkProfil:function(){var e=!0;return this.validateEmail(this.userEmail)?(this.userEmailValid="valid",this.userEmailErrorMsg=""):(e=!1,0===this.userInfos.email.length?(this.userEmailValid="error",this.userEmailErrorMsg="Veuillez renseigner une adresse email"):(this.userEmailValid="error",this.userEmailErrorMsg="Le format de l'adresse email est invalide")),this.validateNames(this.userInfos.lastName)||0===this.userInfos.lastName.length?(this.lastNameValid="valid",this.lastNameErrorMsg=""):(e=!1,this.lastNameValid="error",this.lastNameErrorMsg="Veuillez saisir un Nom valide"),this.validateNames(this.userInfos.firstName)||0===this.userInfos.firstName.length?(this.firstNameValid="valid",this.firstNameErrorMsg=""):(e=!1,this.firstNameValid="error",this.firstNameErrorMsg="Veuillez saisir un Prénom valide"),e},updateProfil:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t,s,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.checkProfil(),!t){e.next=10;break}return s=this.userInfos,s.email=this.userEmail,e.next=6,c()("".concat("http://localhost:3003","/api/updateUser"),{method:"post",data:s});case 6:r=e.sent,"success"===r.data.status&&(this.userEmailValid=!1,this.lastNameValid=!1,this.firstNameValid=!1,le.$emit("notify_app",{status:"success",msg:"Vos informations ont été mises à jour",redirect:!1}),this.$store.dispatch("getUserInfos",this.userInfos.emailHash)),e.next=11;break;case 10:return e.abrupt("return");case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),checkPswd:function(){var e=!0;return 0===this.currentPswd.length?(e=!1,this.currentPswdValid="error",this.currentPswdErrorMsg="Veuillez saisir votre mot de passe actuel"):(this.currentPswdValid="valid",this.currentPswdErrorMsg=""),0===this.newPswd.length?(e=!1,this.newPswdValid="error",this.newPswdErrorMsg="Veuillez saisir un nouveau mot de passe"):this.newPswd===this.currentPswd?(e=!1,this.newPswdValid="error",this.newPswdErrorMsg="Le nouveau mot de passe doit être différent de l'actuel"):this.newPswd.length<8?(e=!1,this.newPswdValid="error",this.newPswdErrorMsg="Votre mot de passe doit contenir au moins 8 caractères"):(this.newPswdValid="valid",this.newPswdErrorMsg=""),0===this.newPswdConfirm.length?(e=!1,this.newPswdConfirmValid="error",this.newPswdConfirmErrorMsg="Veuillez confirmer votre nouveau mot de passe"):this.newPswdConfirm!=this.newPswd?(e=!1,this.newPswdConfirmValid="error",this.newPswdConfirmErrorMsg="Les mots de passe saisis ne correspondent pas"):(this.newPswdConfirmValid="valid",this.newPswdConfirmErrorMsg=""),e},updatePswd:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t,s,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.checkPswd(),!t){e.next=9;break}return s={currentPswd:this.currentPswd,newPswd:this.newPswd,emailHash:this.userInfos.emailHash},e.next=5,c()("".concat("http://localhost:3003","/api/updateUserPswd"),{method:"post",data:s});case 5:r=e.sent,"success"===r.data.status?(le.$emit("notify_app",{status:"success",msg:"Votre mot de passe a été modifié",redirect:!1}),this.$store.dispatch("getUserInfos",this.userInfos.emailHash)):"error"===r.data.status&&(0===r.data.code?(this.currentPswdValid="error",this.currentPswdErrorMsg="Le mot de passe saisi est invalide"):le.$emit("notify_app",{status:r.status,msg:r.data.msg,redirect:!1})),e.next=10;break;case 9:return e.abrupt("return");case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},se=te,re=Object(m["a"])(se,Q,ee,!1,null,null,null),ae=re.exports;r["a"].use(V["a"]);var ie=new V["a"]({mode:"history",base:"/assets/",routes:[{path:"/",name:"home",component:G},{path:"/interface/account",name:"Compte utilisateur",component:ae},{path:"/interface/record",name:"Compte utilisateur",component:K}]}),ne=s("2f62");r["a"].use(ne["a"]);var oe=new ne["a"].Store({strict:!1,state:{userInfos:""},mutations:{SET_USER:function(e,t){e.userInfos={email:t.email,gender:t.gender,deviceType:t.deviceType,firstName:t.firstName,lastName:t.lastName,ageRange:t.ageRange,nbListen:t.nbListen,nbRecord:t.nbRecord,anonymous:t.anonymous,emailHash:t.emailHash}}},actions:{getUserInfos:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t,s){var r,a,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.commit,a=t.state,e.prev=1,e.next=4,c()("".concat("http://localhost:3003","/api/getUserInfos"),{method:"post",data:{hash:s}});case 4:return i=e.sent,r("SET_USER",i.data.user[0]),e.abrupt("return",a.userInfos);case 9:e.prev=9,e.t0=e["catch"](1),console.error(e.t0);case 12:case"end":return e.stop()}},e,null,[[1,9]])}));function t(t,s){return e.apply(this,arguments)}return t}()},getters:{}});s.d(t,"bus",function(){return le}),r["a"].config.productionTip=!1;var le=new r["a"];new r["a"]({router:ie,store:oe,render:function(e){return e(y)}}).$mount("#app")}});
//# sourceMappingURL=index.57301822.js.map