(function(e){function t(t){for(var a,n,o=t[0],c=t[1],l=t[2],u=0,h=[];u<o.length;u++)n=o[u],r[n]&&h.push(r[n][0]),r[n]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);d&&d(t);while(h.length)h.shift()();return i.push.apply(i,l||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],a=!0,o=1;o<s.length;o++){var c=s[o];0!==r[c]&&(a=!1)}a&&(i.splice(t--,1),e=n(n.s=s[0]))}return e}var a={},r={index:0},i=[];function n(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=a,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(s,a,function(t){return e[t]}.bind(null,a));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/assets/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var d=c;i.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"2e93":function(e,t){},"43cb":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"footer"}},[e._v("\n  Copiright Linagora 2019\n")])},r=[];s.d(t,"a",function(){return a}),s.d(t,"b",function(){return r})},4678:function(e,t,s){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function r(e){var t=i(e);return s(t)}function i(e){var t=a[e];if(!(t+1)){var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}return t}r.keys=function(){return Object.keys(a)},r.resolve=i,e.exports=r,r.id="4678"},"56d7":function(e,t,s){"use strict";s.r(t);s("cadf"),s("551c"),s("f751"),s("097d");var a=s("2b0e"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("div",{attrs:{id:"header"}},[s("HeaderApp"),s("AppNotify")],1),s("transition",[s("keep-alive",[s("router-view")],1)],1),s("FooterApp")],1)},i=[],n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"header-container container-fluid"},[s("div",{staticClass:"row"},[e._m(0),s("div",{staticClass:"col text-center"},[s("button",{staticClass:"header-link red",attrs:{"data-url":"/interface/record"},on:{click:function(t){return e.navigate(t)}}},[e._v("S'enregistrer")]),s("span",{staticClass:"text-separator"},[e._v(" | ")]),s("button",{staticClass:"header-link green",attrs:{"data-url":"/interface/listen"},on:{click:function(t){return e.navigate(t)}}},[e._v("Écouter")])]),s("div",{staticClass:"col user-panel"},[e.userConnected?e._e():s("button",{staticClass:"button red",on:{click:function(t){return e.toggleConnectionModal()}}},[e._v("Se connecter/S'inscrire")]),e.userConnected?s("div",{staticClass:"user-menu"},[s("button",{staticClass:"toggle-user-menu",class:[e.showUserMenu?"opened":"closed"],on:{click:e.toggleUserMenu}},[s("span",{staticClass:"label"},[e._v(e._s(e.userInfos.email))]),s("span",{staticClass:"icon"})]),s("div",{staticClass:"user-submenu",class:[e.showUserMenu?"visible":"hidden"]},[e._m(1),e.isAdmin?s("a",{staticClass:"user-submenu-link",attrs:{href:"/interface/scenarios"}},[s("span",{staticClass:"icon wakewords"}),s("span",{staticClass:"label wakewords"},[e._v("Scénarios")])]):e._e(),e.isAdmin?s("a",{staticClass:"user-submenu-link",attrs:{href:"/interface/monitoring"}},[s("span",{staticClass:"icon wakewords"}),s("span",{staticClass:"label wakewords"},[e._v("Monitoring")])]):e._e(),e._m(2)])]):e._e()])])])},o=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col logo-container"},[s("a",{attrs:{href:"/"}},[s("img",{attrs:{id:"wakemeup-logo",src:"/assets/img/wakemeup-logo.svg",alt:"Wake Me Up"}})]),s("img",{attrs:{id:"linagora-labs-logo",src:"/assets/img/linagora-labs.png",alt:"Linagora Labs"}})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a",{staticClass:"user-submenu-link",attrs:{href:"/interface/account"}},[s("span",{staticClass:"icon user"}),s("span",{staticClass:"label user"},[e._v("Mon compte")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a",{staticClass:"user-submenu-link logout",attrs:{href:"/logout"}},[s("span",{staticClass:"icon logout"}),s("span",{staticClass:"label logout"},[e._v("Déconnexion")])])}],c=(s("28a5"),s("bc3a")),l=s.n(c),d={data:function(){return{userConnected:!1,showUserMenu:!1,isAdmin:!1}},created:function(){var e=this,t=this.getCookie("wmu_user");"disconnected"!==t&&this.$store.dispatch("getUserInfos",t).then(function(t){t&&(e.userConnected=!0)},function(e){console.error("error:",err)})},computed:{userInfos:function(){return this.$store.state.userInfos}},watch:{userInfos:function(e){"administrator"===e.role&&(this.isAdmin=!0)}},methods:{toggleConnectionModal:function(){Ue.$emit("toggle_connection_modal",{})},toggleUserMenu:function(){this.showUserMenu=!this.showUserMenu},getCookie:function(e){for(var t=e+"=",s=document.cookie.split(";"),a=0;a<s.length;a++){var r=s[a];while(" "==r.charAt(0))r=r.substring(1);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return""},navigate:function(e){if(this.userConnected){var t=e.target.getAttribute("data-url");window.location.href=t}else this.toggleConnectionModal()}}},u=d,h=s("2877"),v=Object(h["a"])(u,n,o,!1,null,null,null),p=v.exports,f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{style:e.notifHeight,attrs:{id:"notifyApp"}},[s("div",{class:e.status,attrs:{id:"notif-container"}},[s("span",{staticClass:"notif-line"}),s("span",{staticClass:"icon"}),s("span",{staticClass:"label"},[e._v(e._s(e.msg))])])])},m=[],g=(s("96cf"),s("3b8d")),w={data:function(){return{msg:"",status:"",redirect:"",notifHeight:"height: 0px;"}},mounted:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:Ue.$on("notify_app",function(e){t.msg=e.msg,t.status=e.status,t.redirect=e.redirect,t.redirect&&(t.msg+=" Vous serez redirigé dans 3sec..."),setTimeout(function(){var e=document.getElementById("notif-container").offsetHeight;t.notifHeight="height: "+(e+10)+"px"},200),setTimeout(function(){t.notifHeight="height: 0px;",t.redirect&&(document.location.href=t.redirect)},3e3)});case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},b=w,C=Object(h["a"])(b,f,m,!1,null,null,null),_=C.exports,y=s("fd2d"),k={data:function(){return{}},components:{HeaderApp:p,AppNotify:_,FooterApp:y["default"]}},E=k,j=Object(h["a"])(E,r,i,!1,null,null,null),P=j.exports,M=s("8c4f"),R=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-100"},[s("div",{attrs:{id:"page-content"}},[s("div",{attrs:{id:"home"}},[s("div",{staticClass:"container-fluid",attrs:{id:"highlight"}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col talk"},[s("h2",[e._v("Enregistrez votre voix")]),e._m(0),s("div",{staticClass:"highlight-content"},[e._v("Participez à l'enregistrement de campagnes de \"wakewords\". Enregistrez votre voix et créez des échantillons audio qui nous permettront d'enrichir et entraîner notre modèle de données.")]),s("div",{staticClass:"highlight-action"},[s("button",{staticClass:"button red",attrs:{"data-url":"/interface/record"},on:{click:function(t){return e.navigate(t)}}},[e._v("Enregistrez votre voix")])])]),s("div",{staticClass:"col listen"},[s("h2",[e._v("Écoutez et participez à la validation")]),e._m(1),s("div",{staticClass:"highlight-content"},[e._v("Aidez-nous à confirmer la validité des échantillons audios créés par les utilisateurs. Ecoutez ces échantillons et donnez-nous votre avis en nous indiquant si les wakewords prononcés sont audibles et conformes aux consignes.")]),s("div",{staticClass:"highlight-action"},[s("button",{staticClass:"button green",attrs:{"data-url":"/interface/listen"},on:{click:function(t){return e.navigate(t)}}},[e._v("Écouter des enregistrements")])])])])]),s("div",{staticClass:"divider red shadowTop"})])]),s("ConnectionModal"),s("CreateAccountModal")],1)},V=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"title-icon"},[s("img",{attrs:{src:"/assets/img/talk.svg",alt:"Parler"}})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"title-icon"},[s("img",{attrs:{src:"/assets/img/listen.svg",alt:"Ecouter"}})])}],x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"modal",class:[e.showConnectionModal?"visible":"hidden"]},[s("div",{staticClass:"modal-container"},[s("div",{staticClass:"modal-header"},[s("h3",{staticClass:"modal-title red"},[e._v("Se connecter")]),s("button",{staticClass:"close-modal",on:{click:e.closeModal}})]),s("div",{staticClass:"modal-body"},[s("span",[e._v("Veuillez renseigner vos identifiants")]),s("div",{staticClass:"field-container"},[e._m(0),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userEmail,expression:"userEmail"}],staticClass:"input",class:["error"===e.userEmailValid?"error":"","valid"===e.userEmailValid?"valid":""],attrs:{type:"text"},domProps:{value:e.userEmail},on:{input:function(t){t.target.composing||(e.userEmail=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.userEmailErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userEmailErrorMsg))])]),s("div",{staticClass:"field-container"},[e._m(1),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userPswd,expression:"userPswd"}],staticClass:"input",class:["error"===e.userPswdValid?"error":"","valid"===e.userPswdValid?"valid":""],attrs:{type:"password"},domProps:{value:e.userPswd},on:{input:function(t){t.target.composing||(e.userPswd=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.userPswdErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userPswdErrorMsg))])]),s("div",{staticClass:"field-container btn"},[s("button",{staticClass:"button red large",on:{click:function(t){return e.sendLogin()}}},[e._v("S'identifier")])]),s("button",{staticClass:"aslink"},[e._v("Identifiants oubliés ?")]),s("div",{staticClass:"spacer"}),s("div",{staticClass:"divider red"}),s("div",{staticClass:"spacer"}),s("span",[e._v("Vous n'avez pas d'identifiants ?")]),s("div",{staticClass:"field-container btn"},[s("button",{staticClass:"button green large",on:{click:e.toggleCreateAccountModal}},[e._v("Créer un compte")])])])])])])},A=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label"},[s("span",{staticClass:"icon user"}),s("span",{staticClass:"label"},[e._v("Adresse email:")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label"},[s("span",{staticClass:"icon pswd"}),s("span",{staticClass:"label"},[e._v("Mot de passe :")])])}],I={data:function(){return{showConnectionModal:!1,userEmail:"rlopez@linagora.com",userEmailValid:!1,userEmailErrorMsg:"",userPswd:"admin",userPswdValid:!1,userPswdErrorMsg:""}},mounted:function(){var e=this;Ue.$on("toggle_connection_modal",function(){e.toggleConnectionModal()})},methods:{toggleConnectionModal:function(){this.showConnectionModal=!this.showConnectionModal},closeModal:function(){this.showConnectionModal=!1},toggleCreateAccountModal:function(){this.showConnectionModal=!1,Ue.$emit("toggle_create_account_modal",{})},validateEmail:function(e){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)},checkForm:function(){return 0===this.userEmail.length?(this.userEmailValid="error",this.userEmailErrorMsg="Vous devez renseigner une adresse email de connection"):this.validateEmail(this.userEmail)?(this.userEmailValid="valid",this.userEmailErrorMsg=""):(this.userEmailValid="error",this.userEmailErrorMsg="Le format de l'adresse email est invalide"),0===this.userPswd.length?(this.userPswdValid="error",this.userPswdErrorMsg="Veuillez renseigner un mot de passe"):(this.userPswdValid="valid",this.userPswdErrorMsg=""),"valid"===this.userEmailValid&&"valid"===this.userPswdValid},sendLogin:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t,s,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.checkForm(),!t){e.next=7;break}return s={email:this.userEmail,password:this.userPswd},e.next=5,l()("http://localhost:3003/login/userAuth",{method:"post",data:s});case 5:a=e.sent,"error"===a.data.status?"user"===a.data.field?(this.userEmailValid="error",this.userEmailErrorMsg=a.data.msg):"password"===a.data.field&&(this.userPswdValid="error",this.userPswdErrorMsg=a.data.msg):"success"===a.data.status&&(document.location.href="/");case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},S=I,$=Object(h["a"])(S,x,A,!1,null,null,null),O=$.exports,z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"modal",class:[e.showCreateAccountModal?"visible":"hidden"]},[s("div",{staticClass:"modal-container"},[s("div",{staticClass:"modal-header"},[s("h3",{staticClass:"modal-title green"},[e._v("Créer un compte")]),s("button",{staticClass:"close-modal",on:{click:function(t){return e.closeModal()}}}),s("button",{staticClass:"back-login-modal",on:{click:function(t){return e.backToLogin()}}})]),s("div",{staticClass:"modal-body"},[s("div",{staticClass:"field-container"},[e._m(0),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userEmail,expression:"userEmail"}],staticClass:"input",class:["error"===e.userEmailValid?"error":"","valid"===e.userEmailValid?"valid":""],attrs:{type:"text"},domProps:{value:e.userEmail},on:{input:function(t){t.target.composing||(e.userEmail=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.userEmailErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userEmailErrorMsg))])]),s("div",{staticClass:"field-container"},[e._m(1),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userPswd,expression:"userPswd"}],staticClass:"input",class:["error"===e.userPswdValid?"error":"","valid"===e.userPswdValid?"valid":""],attrs:{type:"password"},domProps:{value:e.userPswd},on:{input:function(t){t.target.composing||(e.userPswd=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.userPswdErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userPswdErrorMsg))])]),s("div",{staticClass:"field-container"},[e._m(2),s("input",{directives:[{name:"model",rawName:"v-model",value:e.userPswdConfirm,expression:"userPswdConfirm"}],staticClass:"input",class:["error"===e.userPswdConfirmValid?"error":"","valid"===e.userPswdConfirmValid?"valid":""],attrs:{type:"password"},domProps:{value:e.userPswdConfirm},on:{input:function(t){t.target.composing||(e.userPswdConfirm=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.userPswdConfirmdErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userPswdConfirmdErrorMsg))])]),s("div",{staticClass:"field-container"},[s("div",{staticClass:"field-label"},[s("span",{staticClass:"required"},[e._v("*")]),s("span",{staticClass:"label"},[e._v("Sexe :")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.userGender,expression:"userGender"}],staticClass:"select",class:["error"===e.userGenderValid?"error":"","valid"===e.userGenderValid?"valid":""],on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.userGender=t.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"",hidden:""}},[e._v("Sélectionner un sexe")]),s("option",{attrs:{value:"male"}},[e._v("Homme")]),s("option",{attrs:{value:"female"}},[e._v("Femme")])])]),s("span",{staticClass:"error-field",class:[e.userGenderErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userGenderErrorMsg))])]),s("div",{staticClass:"field-container"},[e._m(3),s("div",{staticClass:"micro-type-container"},[s("div",{staticClass:"micro-type-item",class:["default"==e.deviceType?"active":""],on:{click:function(t){return e.setMicrophone("default")}}},[s("span",{staticClass:"icon default"}),s("span",{staticClass:"label"},[e._v("Micro par défaut")])]),s("div",{staticClass:"micro-type-item",class:["casque"==e.deviceType?"active":""],on:{click:function(t){return e.setMicrophone("casque")}}},[s("span",{staticClass:"icon casque"}),s("span",{staticClass:"label"},[e._v("Micro-casque")])]),s("div",{staticClass:"micro-type-item",class:["pied"==e.deviceType?"active":""],on:{click:function(t){return e.setMicrophone("pied")}}},[s("span",{staticClass:"icon pied"}),s("span",{staticClass:"label"},[e._v("Micro à pied")])])])]),s("div",{staticClass:"field-container btn"},[s("button",{staticClass:"button green large",on:{click:function(t){return e.sendForm()}}},[e._v(e._s(e.btnCreateAccountLabel))]),s("span",{staticClass:"status-field",class:[e.createAccountStatus.length>0?"visible "+e.createAccountStatus:"hidden"]},[e._v(e._s(e.createAccoutMsg))])])])])])])},N=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label"},[s("span",{staticClass:"required"},[e._v("*")]),s("span",{staticClass:"label"},[e._v("Adresse email:")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label"},[s("span",{staticClass:"required"},[e._v("*")]),s("span",{staticClass:"label"},[e._v("Mot de passe :")]),s("button",{staticClass:"info-label"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label"},[s("span",{staticClass:"required"},[e._v("*")]),s("span",{staticClass:"label"},[e._v("Confirmation du mot de passe :")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"field-label"},[s("span",{staticClass:"required"},[e._v("*")]),s("span",{staticClass:"label"},[e._v("Type de mircophone :")])])}],L={data:function(){return{showCreateAccountModal:!1,deviceType:"default",userEmail:"",userEmailValid:!1,userEmailErrorMsg:"",userPswd:"",userPswdValid:!1,userPswdErrorMsg:"",userPswdConfirm:"",userPswdConfirmValid:!1,userPswdConfirmdErrorMsg:"",userGender:"",userGenderValid:!1,userGenderErrorMsg:"",btnCreateAccountLabel:"Créer un compte",createAccountStatus:"",createAccoutMsg:""}},mounted:function(){var e=this;Ue.$on("toggle_create_account_modal",function(){e.showCreateAccountModal=!0})},methods:{setMicrophone:function(e){this.deviceType=e},closeModal:function(){this.showCreateAccountModal=!1},backToLogin:function(){this.showCreateAccountModal=!1,Ue.$emit("toggle_connection_modal",function(){})},validateEmail:function(e){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)},sendForm:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t,s,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.checkForm(),!t){e.next=12;break}return this.btnCreateAccountLabel="Création en cours...",s={email:this.userEmail,pswd:this.userPswd,gender:this.userGender,deviceType:this.deviceType},e.next=6,l()("http://localhost:3003/login/createUser",{method:"post",data:s});case 6:a=e.sent,this.createAccountStatus=a.data.status,this.createAccoutMsg=a.data.msg,"success"===a.data.status?(this.btnCreateAccountLabel="Succès",this.createAccoutMsg+=", vous allez être redirigé dans 3 sec",this.setCookie("wmu_user",a.data.userHash),setTimeout(function(){document.location.href="/"},3e3)):this.btnCreateAccountLabel="Créer un compte",e.next=13;break;case 12:return e.abrupt("return");case 13:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),checkForm:function(){return 0===this.userEmail.length?(this.userEmailValid="error",this.userEmailErrorMsg="Veuillez renseigner une adresse email"):this.validateEmail(this.userEmail)?(this.userEmailValid="valid",this.userEmailErrorMsg=""):(this.userEmailValid="error",this.userEmailErrorMsg="Le format de l'adresse email est invalide"),0===this.userPswd.length?(this.userPswdValid="error",this.userPswdErrorMsg="Veuillez renseigner un mot de passe"):this.userPswd.length<8?(this.userPswdValid="error",this.userPswdErrorMsg="Le mot de passe doit contenir au moins 8 caractères"):(this.userPswdValid="valid",this.userPswdErrorMsg=""),0===this.userPswdConfirm.length?this.userPswdConfirmValid="error":this.userPswdConfirm!==this.userPswd?(this.userPswdConfirmValid="error",this.userPswdConfirmdErrorMsg="Les mots de passes doivent êtres identiques"):(this.userPswdConfirmValid="valid",this.userPswdConfirmdErrorMsg=""),""===this.userGender?(this.userGenderValid="error",this.userGenderErrorMsg="Veuillez sélectionner un sexe"):(this.userGenderValid="valid",this.userGenderErrorMsg=""),"valid"===this.userEmailValid&&"valid"===this.userPswdValid&&"valid"===this.userPswdConfirmValid&&"valid"===this.userGenderValid},setCookie:function(e,t,s){var a=new Date;a.setTime(a.getTime()+24*s*60*60);var r="expires="+a.toUTCString();document.cookie=e+"="+t+";"+r+";path=/"},getCookie:function(e){for(var t=e+"=",s=document.cookie.split(";"),a=0;a<s.length;a++){var r=s[a];while(" "==r.charAt(0))r=r.substring(1);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return""}}},T=L,U=Object(h["a"])(T,z,N,!1,null,null,null),q=U.exports,D={data:function(){return{showConnectModal:!1,userConnected:!1}},created:function(){var e=this,t=this.getCookie("wmu_user");"disconnected"!==t&&this.$store.dispatch("getUserInfos",t).then(function(t){t&&(e.userConnected=!0)},function(e){console.error("error:",err)})},computed:{userInfos:function(){return this.$store.state.userInfos}},methods:{navigate:function(e){if(this.userConnected){var t=e.target.getAttribute("data-url");window.location.href=t}else Ue.$emit("toggle_connection_modal",{})},getCookie:function(e){for(var t=e+"=",s=document.cookie.split(";"),a=0;a<s.length;a++){var r=s[a];while(" "==r.charAt(0))r=r.substring(1);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return""}},components:{Header:p,ConnectionModal:O,CreateAccountModal:q}},H=D,F=Object(h["a"])(H,R,V,!1,null,null,null),B=F.exports,W=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-100"},[s("div",{staticClass:"locked",attrs:{id:"page-content"}},[s("div",{staticClass:"container-fluid h-100 talk green",attrs:{id:"player-container"}},[s("div",{staticClass:"row h-100"},[e._m(0),s("div",{staticClass:"col-8 h-100"},[e.audiosReady&&!e.noMoreAudio?s("div",{attrs:{id:"player-wrapper"}},[s("div",{staticClass:"say-word"},[s("h3",[e._v('"'),s("span",{staticClass:"word"},[e._v(e._s(e.wakeword))]),e._v('"')])]),s("div",[s("div",{staticClass:"btn-container"},[s("div",{staticClass:"player-anim"},[s("span",{staticClass:"sound-bar bsmall",class:[e.isRecording?"animate":""]}),s("span",{staticClass:"sound-bar bmed",class:[e.isRecording?"animate":""]}),s("span",{staticClass:"sound-bar bbig",class:[e.isRecording?"animate":""]})]),s("button",{staticClass:"button-play",class:e.isPlaying,attrs:{id:"start"},on:{click:function(t){return e.playAudio()}}}),s("div",{staticClass:"player-anim"},[s("span",{staticClass:"sound-bar bbig",class:[e.isRecording?"animate":""]}),s("span",{staticClass:"sound-bar bmed",class:[e.isRecording?"animate":""]}),s("span",{staticClass:"sound-bar bsmall",class:[e.isRecording?"animate":""]})]),s("span",{staticClass:"label"},[e._v("Écouter")])]),e.audioHasBeenListen&&!e.isPlaying?s("div",{staticClass:"sub-actions-container"},[s("div",{staticClass:"action-container"},[s("button",{staticClass:"btn-player votegood",on:{click:function(t){return e.sendVote("good")}}}),s("span",{staticClass:"label green"},[e._v("Valide")])]),s("div",{staticClass:"action-container"},[s("button",{staticClass:"btn-player votebad",on:{click:function(t){return e.sendVote("bad")}}}),s("span",{staticClass:"label red"},[e._v("Non valide")])])]):e._e()])]):e._e(),e.audiosReady||e.noMoreAudio?e._e():s("div",{staticClass:"loading"},[s("img",{staticClass:"loading-img",attrs:{src:"/assets/img/loading.gif"}}),s("span",{staticClass:"label"},[e._v("Chargement...")])]),!e.audiosReady&&e.noMoreAudio?s("div",{staticClass:"record-complete white-container"},[e._v('\n              Vous n\'avez pas de "wake-word" à valider.'),s("br"),s("a",{attrs:{href:"/"}},[e._v("Retour à l'accueil")])]):e._e()])])])])])},G=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col-4 h-100 player-content"},[s("h2",{staticClass:"green"},[e._v("Écoutez et validez des enregistrement")]),s("div",{staticClass:"content green"},[s("p",[e._v("Bienvenue dans l'interface de validation des wakewords.")]),s("p",[s("strong",[e._v("Écoutez")]),e._v(" les enregistrements réalisés par les utilsateurs.")]),s("p",[e._v(" Pour qu'un son soit valide, il doit répondre à certains critères :\n              "),s("ul",[s("li",[e._v("Le wakewords doit être "),s("strong",[e._v("clairement audible")])]),s("li",[e._v("La commande prononcée doit être "),s("strong",[e._v("conforme avec la commande écrites au-dessus du player")])]),s("li",[e._v("Il ne doit "),s("strong",[e._v("pas")]),e._v(" y avoir de "),s("strong",[e._v("sons parasites")]),e._v(" pendant la prononciation du wakeword")])])]),s("div",{staticClass:"notice"},[s("h3",[e._v("Validation d'échantillons audio")]),s("ul",[s("li",[e._v("Le wakeword attendu est écris en rouge au-dessus du player audio")]),s("li",[e._v('Cliquez sur le bouton "'),s("strong",[e._v("Écouter")]),e._v('" afin de jouer le son. ')]),s("li",[e._v("Après avoir écouté le son, des boutons vous permettant de voter apparaitrons")]),s("li",[e._v('Cliquez sur le bouton "'),s("strong",[e._v("Valide")]),e._v("\" si vous estimez que l'échantillon est valide")]),s("li",[e._v('Cliquez sur le bouton "'),s("strong",[e._v("Non valide")]),e._v("\" si vous estimez que l'échantillon n'est pas valide")])])])])])}],Y=s("bd86"),J={data:function(){var e;return e={audiosReady:!1,wakeword:"",audioFile:"",userHash:"",isPlaying:"",playerAudio:null,audioHasBeenListen:!1,noMoreAudio:!1},Object(Y["a"])(e,"userHash",""),Object(Y["a"])(e,"userAudios",""),e},created:function(){this.$store.dispatch("getAudios").then(function(e){},function(e){console.error("error:",err)})},computed:{userInfos:function(){return this.$store.state.userInfos},audios:function(){return this.$store.state.audios}},watch:{userInfos:function(e){this.userHash=this.$store.state.userInfos.userHash},userHash:function(e){this.audios&&(this.userAudios=this.$store.getters.AUDIO_BY_USER(e))},audios:function(e){this.userHash&&(this.userAudios=this.$store.getters.AUDIO_BY_USER(this.userHash))},userAudios:function(e){e.length>0?(this.noMoreAudio=!1,this.wakeword=e[0].wakeword,this.audioFile="/assets/audios/"+e[0].fieldname,this.audiosReady=!0,this.playerAudio=new Audio(this.audioFile)):(this.audiosReady=!1,this.noMoreAudio=!0)}},methods:{playAudio:function(){var e=this;this.isPlaying="active",this.playerAudio.play(),this.playerAudio.addEventListener("ended",function(){e.isPlaying="",e.audioHasBeenListen=!0})},sendVote:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t){var s,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return s={audioId:this.userAudios[0]._id,vote:t,userHash:this.userInfos.userHash,wakeword:this.wakeword},e.next=3,l()("".concat("http://localhost:3003","/api/audios/vote"),{method:"post",data:s});case 3:a=e.sent,"success"===a.data.voteAudio?Ue.$emit("notify_app",{status:"success",msg:"Vote pris en compte.",redirect:"/interface/listen"}):Ue.$emit("notify_app",{status:"error",msg:"Erreur lors de l'enregistrement",redirect:!1});case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}},Z=J,K=Object(h["a"])(Z,W,G,!1,null,null,null),Q=K.exports,X=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-100"},[s("div",{attrs:{id:"page-content"}},[s("div",{staticClass:"container-fluid",attrs:{id:"user-panel"}},[s("div",{staticClass:"row justify-content-around"},[e.appStatsReady?s("div",{staticClass:"col-6"},[s("h2",[e._v("Statistiques d'utilisation")]),s("div",{staticClass:"white-container"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col monitoring-appstats record"},[s("span",{staticClass:"label"},[e._v("Nombre d'enregistrements")]),s("span",{staticClass:"icon"}),s("span",{staticClass:"number"},[e._v(e._s(e.appStats.nbRecord))])]),s("div",{staticClass:"col monitoring-appstats listen"},[s("span",{staticClass:"label"},[e._v("Nombre d'écoutes")]),s("span",{staticClass:"icon"}),s("span",{staticClass:"number"},[e._v(e._s(e.appStats.nbListen))])])])])]):e._e(),e.genderRatioReady?s("div",{staticClass:"col-4"},[s("h2",[e._v("Ratio femme / homme")]),s("div",{staticClass:"white-container"},[s("span",{staticClass:"monitoring-datas"},[e._v("Hommes: "+e._s(e.genderRatio.pctMale)+" % - Femmes: "+e._s(e.genderRatio.pctFemale)+" %")]),s("canvas",{attrs:{id:"genderRatio",width:"400",height:"400"}},[e._v("Your browser does not support the canvas element.")])])]):e._e()]),s("div",{},[e.deviceRatioReady?s("div",{staticClass:"col-4"},[s("h2",[e._v("Devices")]),e._m(0)]):e._e()])])])])},ee=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"white-container"},[s("canvas",{attrs:{id:"devicesRatio",width:"400",height:"400"}},[e._v("Your browser does not support the canvas element.")])])}],te=s("30ef"),se=s.n(te),ae={data:function(){return{scenariosReady:!1,appStatsReady:!1,genderRatio:"",genderRatioReady:!1,deviceRatio:"",deviceRatioReady:!1}},computed:{scenarios:function(){return this.$store.state.scenarios},appStats:function(){return this.$store.getters.APP_STATS},audios:function(){return this.$store.state.audios}},created:function(){var e=this;this.$store.dispatch("getScenarios").then(function(t){e.$store.dispatch("getAudios").then(function(e){},function(e){console.error("error:",err)})},function(e){console.error("error:",err)})},watch:{scenarios:function(e){e.length>0&&(this.scenariosReady=!0)},appStats:function(e){this.appStatsReady=!0},audios:function(e){e.length>0&&(this.genderRatio=this.$store.getters.GENDER_RATIO,this.deviceRatio=this.$store.getters.DEVICES_RATIO)},genderRatio:function(e){var t=this;this.genderRatioReady=!0,setTimeout(function(){t.setGenderChart()},500)},deviceRatio:function(e){var t=this;this.deviceRatioReady=!0,setTimeout(function(){t.setDevicesChart()},500)}},methods:{setGenderChart:function(){this.createChart("genderRatio",{type:"pie",data:{labels:["Hommes","Femmes"],datasets:[{data:[this.genderRatio.pctMale,this.genderRatio.pctFemale],backgroundColor:["#7ee557","#ed4877"]}]},options:{}})},setDevicesChart:function(){this.createChart("devicesRatio",{type:"pie",data:{labels:["Default","Micro-casque","Micro à pied"],datasets:[{data:[this.deviceRatio.prctDefault,this.deviceRatio.prctHeadphone,this.deviceRatio.prctExternal],backgroundColor:["#7ee557","#ed4877","#22a8f2"]}]},options:{}})},createChart:function(e,t){var s=document.getElementById(e);new se.a(s,{type:t.type,data:t.data,options:t.options})}}},re=ae,ie=Object(h["a"])(re,X,ee,!1,null,null,null),ne=ie.exports,oe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-100"},[s("div",{staticClass:"locked",attrs:{id:"page-content"}},[s("div",{staticClass:"container-fluid h-100 talk red",attrs:{id:"player-container"}},[s("div",{staticClass:"row h-100"},[e._m(0),s("div",{staticClass:"col-8 h-100"},[e.dataReady&&!e.allComplete?s("div",{attrs:{id:"player-wrapper"}},[s("div",{staticClass:"say-word"},[s("h3",[e._v('Dites : "'),s("span",{staticClass:"word"},[e._v(e._s(e.wakeword))]),e._v('"')])]),s("div",{staticClass:"btn-container"},[s("div",{staticClass:"player-anim"},[s("span",{staticClass:"sound-bar bsmall",class:[e.isRecording?"animate":""]}),s("span",{staticClass:"sound-bar bmed",class:[e.isRecording?"animate":""]}),s("span",{staticClass:"sound-bar bbig",class:[e.isRecording?"animate":""]})]),e.isRecording?e._e():s("button",{staticClass:"button-record",attrs:{id:"start"},on:{click:function(t){return e.startRecording()}}},[s("span",{staticClass:"icon"})]),e.isRecording?s("button",{staticClass:"button-record isRecording",attrs:{id:"stop"},on:{click:function(t){return e.stopRecording()}}},[s("span",{staticClass:"icon isRecording"})]):e._e(),s("div",{staticClass:"player-anim"},[s("span",{staticClass:"sound-bar bbig",class:[e.isRecording?"animate":""]}),s("span",{staticClass:"sound-bar bmed",class:[e.isRecording?"animate":""]}),s("span",{staticClass:"sound-bar bsmall",class:[e.isRecording?"animate":""]})]),s("span",{staticClass:"label"},[e._v("Enregistrer")])]),null===e.blob||e.isRecording?e._e():s("div",{staticClass:"sub-actions-container"},[s("div",{staticClass:"action-container"},[s("button",{staticClass:"btn-player play",class:e.isPlaying,on:{click:function(t){return e.playRecord()}}}),s("span",{staticClass:"label"},[e._v("Réécouter")])]),s("div",{staticClass:"action-container"},[s("button",{staticClass:"btn-player reset",on:{click:function(t){return e.startRecording()}}}),s("span",{staticClass:"label"},[e._v("Recommencer")])]),s("div",{staticClass:"action-container"},[s("button",{staticClass:"btn-player validate",class:e.recordIsValid,on:{click:function(t){return e.validRecord()}}}),s("span",{staticClass:"label"},[e._v("Valider")])])])]):e._e(),e.dataReady&&!e.allComplete?s("div",{staticClass:"player-timeline"},[s("div",{staticClass:"timeline"},[s("div",{staticClass:"progress",class:e.progressClass},[s("span",{staticClass:"progress-info"},[e._v(e._s(e.step)+"/3")])])])]):e._e(),!e.dataReady&&e.allComplete?s("div",{staticClass:"record-complete white-container"},[e._v('\n              Vous n\'avez pas de "wake-word" à enregistrer.'),s("br"),s("a",{attrs:{href:"/"}},[e._v("Retour à l'accueil")])]):e._e(),e.dataReady||e.allComplete?e._e():s("div",{staticClass:"loading"},[s("img",{staticClass:"loading-img",attrs:{src:"/assets/img/loading.gif"}}),s("span",{staticClass:"label"},[e._v("Chargement...")])])])])])])])},ce=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col-4 h-100 player-content"},[s("h2",{staticClass:"red"},[e._v("Enregistrez votre voix")]),s("div",{staticClass:"content red"},[s("p",[e._v("Bienvenue dans l'interface d'enregistrement des wakewords.")]),s("p",[e._v("L'enregistrement des wakeword nécessite qu'un "),s("strong",[e._v("microphone")]),e._v(" soit detecté par votre navigateur. Lors de votre inscription, vous avez du sélectionner un type de périphérique. Vous pouvez mettre à jour ces informations en vous rendant dans l'interface utilisateur.")]),s("p",[e._v("Les données seront enregistrées de façon "),s("strong",[e._v("anonymes")]),e._v(" et renseignerons uniquement le sexe du locuteur. ")]),s("p",[e._v('Chaque "Wakeword" devra être enregistré 3 fois de suite afin que nous puissions avoir un comparatif des différents échantillons.')]),s("div",{staticClass:"notice"},[s("h3",[e._v("Pour enregistrer votre voix")]),s("ul",[s("li",[e._v('La commmande à enregistrer est écrites au-dessus du bouton "enregistrer" sur la partie droite de la page.')]),s("li",[e._v('Cliquez sur le bouton "'),s("strong",[e._v("enregistrer")]),e._v('" afin de commencer la captation. Le bouton se mettra à clignoter pour vous indiquer que la captation est en cours.')]),s("li",[s("strong",[e._v("Prononcez la commande")]),e._v(' et appuyez une nouvelle fois sur le bouton "'),s("strong",[e._v("enregistrer")]),e._v("\" afin d'arrêter la captation.")]),s("li",[e._v("Après avoir enregistré votre voix, vous pourrez "),s("strong",[e._v("réécouter")]),e._v(" votre enregistrement, et le "),s("strong",[e._v("recommencer")]),e._v(" si nécessaire.")]),s("li",[e._v(' Si votre enregistrement vous semble valide, cliquez sur le bouton "'),s("strong",[e._v("valider")]),e._v('" pour le confirmer et passer à un nouvel enregistrement.')])])])])])}],le=s("f499"),de=s.n(le),ue=(s("63d9"),s("e814")),he=s.n(ue),ve=s("c1df"),pe=s.n(ve),fe={data:function(){return{analyser:null,blob:null,buffer:null,bufferSize:4096,context:null,leftchannel:[],leftBuffer:"",mediaRecorder:null,mediaRecorderblob:null,mediaRecorderChunk:[],mediaStream:null,numberOfInputChannels:2,numberOfOutputChannels:2,recorder:null,recordingLength:0,rightchannel:[],rightBufffer:"",sampleRate:44100,sourceNode:null,view:null,volume:null,wakeword:"",audioConfig:null,step:0,scenariosLoaded:!1,dataReady:!1,allComplete:!1,progressClass:"",isRecording:!1,isPlaying:"",recordIsValid:"",userReady:!1,scenariosReady:!1}},created:function(){var e=this;this.$store.dispatch("getScenarios").then(function(t){e.scenariosLoaded=!0},function(e){console.error("error:",err)})},computed:{scenarios:function(){return this.$store.state.scenarios},userInfos:function(){return this.$store.state.userInfos}},watch:{userInfos:function(e){console.log(e),this.userReady=!0},scenarios:function(e){this.scenariosReady=!0},userReady:function(e){!0===e&&!0===this.scenariosReady&&this.setScenario()},scenariosReady:function(e){!0===e&&!0===this.userReady&&this.setScenario()}},methods:{setScenario:function(){var e=this;if(this.userInfos.recordList&&this.userInfos.recordList.length>0)this.userInfos.recordList.map(function(t){t.complete?e.scenarios.map(function(t){var s=t.wakeword,a=!1;e.userInfos.recordList.map(function(e){e.wakeword==s&&(a=!0)}),a||(e.wakeword=t.wakeword,e.step=1,e.audioConfig={label:"noOpt",echoCancellation:t.scenario.noOpt.echoCancellation,noiseSuppression:t.scenario.noOpt.noiseSuppression})}):(e.wakeword=t.wakeword,e.step=he()(t.step)+1,e.scenarios.map(function(s){if(s.wakeword===t.wakeword)for(var a in s.scenario)s.scenario[a].step==e.step&&(e.audioConfig={label:a,echoCancellation:s.scenario[a].echoCancellation,noiseSuppression:s.scenario[a].noiseSuppression})}))});else{var t=this.scenarios[0];this.step=1,this.wakeword=t.wakeword,this.audioConfig={label:"noOpt",echoCancellation:t.scenario.noOpt.echoCancellation,noiseSuppression:t.scenario.noOpt.noiseSuppression}}this.progressClass="step-"+this.step,null===this.audioConfig?(this.allComplete=!0,this.dataReady=!1):(this.dataReady=!0,this.allComplete=!1,this.initRecorder(this.audioConfig))},startRecording:function(){this.leftchannel=[],this.rightchannel=[],this.isRecording=!0,this.mediaRecorder.start(),this.mediaStream.connect(this.recorder),this.recorder.connect(this.context.destination)},stopRecording:function(){var e=new Audio;this.isRecording=!1,this.recorder.disconnect(this.context.destination),this.mediaStream.disconnect(this.recorder),this.mediaRecorder.stop(),this.sourceNode=this.context.createMediaElementSource(e),this.sourceNode.connect(this.context.destination),this.leftBuffer=this.flattenArray(this.leftchannel,this.recordingLength),this.rightBuffer=this.flattenArray(this.rightchannel,this.recordingLength);var t=this.interleave(this.leftBuffer,this.rightBuffer);this.buffer=new ArrayBuffer(44+2*t.length),this.view=new DataView(this.buffer),this.writeUTFBytes(this.view,0,"RIFF"),this.view.setUint32(4,44+2*t.length,!0),this.writeUTFBytes(this.view,8,"WAVE"),this.writeUTFBytes(this.view,12,"fmt "),this.view.setUint32(16,16,!0),this.view.setUint16(20,1,!0),this.view.setUint16(22,2,!0),this.view.setUint32(24,this.sampleRate,!0),this.view.setUint32(28,4*this.sampleRate,!0),this.view.setUint16(32,4,!0),this.view.setUint16(34,16,!0),this.writeUTFBytes(this.view,36,"data"),this.view.setUint32(40,2*t.length,!0);for(var s=44,a=1,r=0;r<t.length;r++)this.view.setInt16(s,t[r]*(32767*a),!0),s+=2;this.blob=new Blob([this.view],{type:"audio/wav"});var i=this.analyser.context.sampleRate,n=this.analyser.channelCount,o=this.analyser.numberOfInputs,c=this.analyser.numberOfOutputs,l=this.recorder.bufferSize;this.webAudioInfos={contextSampleRate:i,bufferSize:l,nbChannels:n,nbInputs:o,nbOutputs:c,options:this.audioConfig.label}},playRecord:function(){var e=this;if(null!=this.blob){this.isPlaying="active";var t=window.URL.createObjectURL(this.blob),s=new Audio(t);s.play(),s.addEventListener("ended",function(){e.isPlaying=""})}},flattenArray:function(e,t){for(var s=new Float32Array(t),a=0,r=0;r<e.length;r++){var i=e[r];s.set(i,a),a+=i.length}return s},interleave:function(e,t){for(var s=e.length+t.length,a=new Float32Array(s),r=0,i=0;i<s;)a[i++]=e[r],a[i++]=t[r],r++;return a},writeUTFBytes:function(e,t,s){for(var a=0;a<s.length;a++)e.setUint8(t+a,s.charCodeAt(a))},sendDatas:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t,s,a){var r,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r={userHash:this.userInfos.userHash,wakeword:this.wakeword,deviceType:this.userInfos.deviceType,step:this.step,gender:this.userInfos.gender},i=new FormData,i.append("webAudioInfos",de()(s)),i.append("userInfos",de()(r)),i.append(a,t,a),e.next=7,l()("".concat("http://localhost:3003","/api/audios/save"),{method:"post",data:i});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}));function t(t,s,a){return e.apply(this,arguments)}return t}(),validRecord:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t,s,a,r,i,n,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=pe()().format("YYYYDDMmmhhmmss"),s=this.wakeword,a=this.audioConfig.label,"male"===this.userInfos.gender?r="M":"female"===this.userInfos.gender&&(r="F"),i="".concat(s,"-").concat(a,"-").concat(r,"-").concat(t),1!==this.step){e.next=15;break}return e.next=8,this.sendDatas(this.blob,this.webAudioInfos,i+".wav");case 8:return n=e.sent,e.next=11,this.sendDatas(this.mediaRecorderblob,this.webAudioInfos,i+".webm");case 11:o=e.sent,"success"===n.data.status&&"success"===o.data.status?(this.recordIsValid="active",Ue.$emit("notify_app",{status:"success",msg:"Enregistrement validé",redirect:"/interface/record"})):Ue.$emit("notify_app",{status:"error",msg:"Erreur lors de l'enregistrement",redirect:!1}),e.next=19;break;case 15:return e.next=17,this.sendDatas(this.blob,this.webAudioInfos,i+".wav");case 17:n=e.sent,"success"===n.data.status?(this.recordIsValid="active",Ue.$emit("notify_app",{status:"success",msg:"Enregistrement validé",redirect:"/interface/record"})):Ue.$emit("notify_app",{status:"error",msg:"Erreur lors de l'enregistrement",redirect:!1});case 19:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),initRecorder:function(e){var t=this;navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({audio:{channelCount:{min:1,ideal:2},echoCancellation:e.echoCancellation,noiseSuppression:e.noiseSuppression}}).then(function(e){document.getElementById("start"),document.getElementById("stop");window.AudioContext=window.AudioContext||window.webkitAudioContext,t.context=new AudioContext,t.mediaStream=t.context.createMediaStreamSource(e),t.analyser=t.context.createAnalyser(),t.mediaRecorder=new MediaRecorder(e),t.context.createScriptProcessor?t.recorder=t.context.createScriptProcessor(t.bufferSize,t.numberOfInputChannels,t.numberOfOutputChannels):t.recorder=t.context.createJavaScriptNode(t.bufferSize,t.numberOfInputChannels,t.numberOfOutputChannels),t.mediaRecorderChunk=[],t.mediaRecorder.ondataavailable=function(e){t.mediaRecorderChunk.push(e.data),t.mediaRecorderblob=new Blob(t.mediaRecorderChunk,{type:"audio/webm; codecs=opus"})},t.recorder.onaudioprocess=function(e){t.leftchannel.push(new Float32Array(e.inputBuffer.getChannelData(0))),t.rightchannel.push(new Float32Array(e.inputBuffer.getChannelData(1))),t.recordingLength+=t.bufferSize}}).catch(function(e){console.error(e)})}}},me=fe,ge=Object(h["a"])(me,oe,ce,!1,null,null,null),we=ge.exports,be=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-100"},[s("div",{attrs:{id:"page-content"}},[e.isAdmin&&e.scenariosLoaded?s("div",{staticClass:"container-fluid",attrs:{id:"user-panel"}},[s("div",{staticClass:"row justify-content-around"},[s("div",{staticClass:"col-5"},[s("h2",[e._v("Ajouter un wakeword")]),s("div",{staticClass:"white-container"},[s("table",{staticClass:"user-panel-tab"},[s("tbody",[s("tr",[s("td",{staticClass:"tab-label"},[e._v("Wakeword :")]),s("td",{staticClass:"tab-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.wakeword,expression:"wakeword"}],staticClass:"input",class:["error"===e.wakewordValid?"error":"","valid"===e.wakewordValid?"valid":""],domProps:{value:e.wakeword},on:{input:function(t){t.target.composing||(e.wakeword=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.wakewordErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.wakewordErrorMsg))])])]),s("tr",[s("td",{staticStyle:{"padding-top":"10px"},attrs:{colspan:"2"}},[s("button",{staticClass:"button green large",on:{click:function(t){return e.addWakeword(e.wakeword)}}},[e._v("Ajouter un wakeword")])])])])])])]),s("div",{staticClass:"col-5"},[s("h2",[e._v("Wakewords existants")]),s("div",{staticClass:"white-container"},e._l(e.scenarios,function(t){return s("div",{key:t._id,staticClass:"ww-container"},[s("span",{staticClass:"wakeword"},[e._v(e._s(t.wakeword))]),s("div",{staticClass:"wakeword-info"},[s("span",{staticClass:"label listen"},[e._v("Ecoutes")]),s("span",{staticClass:"number listen"},[e._v(e._s(t.nbListen))])]),s("div",{staticClass:"wakeword-info"},[s("span",{staticClass:"label record"},[e._v("Enreg.")]),s("span",{staticClass:"number record"},[e._v(e._s(t.nbRecord))])]),s("button",{staticClass:"delete-btn",on:{click:function(s){return e.deleteWakeword(t.wakeword)}}})])}),0)])])]):s("div",[e._v("\n      Vous n'êtes pas autorisé à accéder à cette page "),s("br"),s("a",{attrs:{href:"/"}},[e._v("Retour à la page d'accueil")])])]),s("DeleteWakewordModal")],1)},Ce=[],_e=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"modal",class:[e.showModal?"visible":"hidden"]},[s("div",{staticClass:"modal-container"},[s("div",{staticClass:"modal-header"},[s("h3",{staticClass:"modal-title red"},[e._v("Supprimer un wakeword")]),s("button",{staticClass:"close-modal",on:{click:e.closeModal}})]),s("div",{staticClass:"modal-body"},[s("p",{staticClass:"content"},[e._v('Êtes-vous sûr de vouloir supprimer le wakeword "'),s("strong",[e._v(e._s(e.wakeword))]),e._v("\" des scénarios d'enregistrement ?")]),s("div",{staticClass:"modal-footer"},[s("button",{staticClass:"button grey",on:{click:function(t){return e.closeModal()}}},[e._v("Annuler")]),s("button",{staticClass:"button red",on:{click:function(t){return e.deleteWakeword(e.wakeword)}}},[e._v("Supprimer")])])])])])])},ye=[],ke={data:function(){return{showModal:!1,wakeword:""}},methods:{closeModal:function(){this.showModal=!1},deleteWakeword:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t){var s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l()("".concat("http://localhost:3003","/api/scenarios"),{method:"delete",data:{wakeword:t}});case 2:s=e.sent,"success"===s.data.deleteWakeword?(Ue.$emit("wakeword_deleted",{}),Ue.$emit("notify_app",{status:"success",msg:"Wakeword supprimé avec succès.",redirect:!1})):Ue.$emit("notify_app",{status:"error",msg:"Erreur lors de la suppression du wakeword",redirect:!1}),this.showModal=!1;case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},mounted:function(){var e=this;Ue.$on("show_deleteWakeWord_modal",function(t){e.showModal=!0,e.wakeword=t.wakeword})}},Ee=ke,je=Object(h["a"])(Ee,_e,ye,!1,null,null,null),Pe=je.exports,Me={data:function(){return{isAdmin:!1,scenariosLoaded:!1,wakeword:"",wakewordValid:!1,wakewordErrorMsg:""}},computed:{userInfos:function(){return this.$store.state.userInfos},scenarios:function(){return this.$store.state.scenarios}},created:function(){this.$store.dispatch("getScenarios").then(function(e){},function(e){console.error("error:",err)})},mounted:function(){var e=this;Ue.$on("wakeword_deleted",function(){e.$store.dispatch("getScenarios")})},watch:{userInfos:function(e){"administrator"===e.role?this.isAdmin=!0:this.isAdmin=!1},scenarios:function(e){e.length>0&&(this.scenariosLoaded=!0)}},methods:{validWakeword:function(e){var t=!0;return this.scenarios.map(function(s){s.wakeword===e&&(t=!1)}),t?(this.wakewordValid="valid",this.wakewordErrorMsg="",!0):(this.wakewordValid="error",this.wakewordErrorMsg="Ce wakeword fais déjà parti du scénario d'enregistrement",!1)},addWakeword:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t){var s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.validWakeword(t)){e.next=5;break}return e.next=3,l()("".concat("http://localhost:3003","/api/scenarios"),{method:"post",data:{wakeword:t}});case 3:s=e.sent,"success"===s.data.addWakeword?(this.$store.dispatch("getScenarios"),Ue.$emit("notify_app",{status:"success",msg:"Wakeword ajouté avec succès.",redirect:!1})):Ue.$emit("notify_app",{status:"error",msg:"Erreur lors de l'ajout du wakeword.",redirect:!1});case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),deleteWakeword:function(e){Ue.$emit("show_deleteWakeWord_modal",{wakeword:e})}},components:{DeleteWakewordModal:Pe}},Re=Me,Ve=Object(h["a"])(Re,be,Ce,!1,null,null,null),xe=Ve.exports,Ae=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-100"},[s("div",{attrs:{id:"page-content"}},[s("div",{staticClass:"container-fluid",attrs:{id:"user-panel"}},[s("div",{staticClass:"row justify-content-around"},[s("div",{staticClass:"col-5"},[s("h2",[e._v("Informations utilisateur")]),s("div",{staticClass:"white-container"},[s("table",{staticClass:"user-panel-tab"},[s("tbody",[s("tr",[s("td",{staticClass:"tab-label"},[e._v("Adresse email :")]),s("td",{staticClass:"tab-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userEmail,expression:"userEmail"}],staticClass:"input",class:["error"===e.userEmailValid?"error":"","valid"===e.userEmailValid?"valid":""],domProps:{value:e.userEmail},on:{input:function(t){t.target.composing||(e.userEmail=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.userEmailErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.userEmailErrorMsg))])])]),s("tr",[s("td",{staticClass:"tab-label"},[e._v("Sexe :")]),s("td",{staticClass:"tab-input"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.userInfos.gender,expression:"userInfos.gender"}],staticClass:"select",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.userInfos,"gender",t.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"male"}},[e._v("Homme")]),s("option",{attrs:{value:"female"}},[e._v("Femme")])])])]),s("tr",[s("td",{staticClass:"tab-label"},[e._v("Type de microphone :")]),s("td",{staticClass:"tab-input"},[s("div",{staticClass:"micro-type-container"},[s("div",{staticClass:"micro-type-item",class:["default"===e.userInfos.deviceType?"active":""],on:{click:function(t){return e.setMicrophone("default")}}},[s("span",{staticClass:"icon default"}),s("span",{staticClass:"label"},[e._v("Micro par défaut")])]),s("div",{staticClass:"micro-type-item",class:["casque"===e.userInfos.deviceType?"active":""],on:{click:function(t){return e.setMicrophone("casque")}}},[s("span",{staticClass:"icon casque"}),s("span",{staticClass:"label"},[e._v("Micro-casque")])]),s("div",{staticClass:"micro-type-item",class:["pied"===e.userInfos.deviceType?"active":""],on:{click:function(t){return e.setMicrophone("pied")}}},[s("span",{staticClass:"icon pied"}),s("span",{staticClass:"label"},[e._v("Micro à pied")])])])])])])]),s("div",{staticClass:"spacer"}),s("div",{staticClass:"divider grey"}),s("div",{staticClass:"spacer"}),s("span",{staticClass:"info"},[e._v("Les informations suivantes sont facultatives")]),s("table",{staticClass:"user-panel-tab"},[s("tbody",[s("tr",[s("td",{staticClass:"tab-label"},[e._v("Nom :")]),s("td",{staticClass:"tab-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfos.lastName,expression:"userInfos.lastName"}],staticClass:"input",class:["error"===e.lastNameValid?"error":"","valid"===e.lastNameValid?"valid":""],domProps:{value:e.userInfos.lastName},on:{input:function(t){t.target.composing||e.$set(e.userInfos,"lastName",t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.lastNameErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.lastNameErrorMsg))])])]),s("tr",[s("td",{staticClass:"tab-label"},[e._v("Prénom :")]),s("td",{staticClass:"tab-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfos.firstName,expression:"userInfos.firstName"}],staticClass:"input",class:["error"===e.firstNameValid?"error":"","valid"===e.firstNameValid?"valid":""],domProps:{value:e.userInfos.firstName},on:{input:function(t){t.target.composing||e.$set(e.userInfos,"firstName",t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.firstNameErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.firstNameErrorMsg))])])]),s("tr",[s("td",{staticClass:"tab-label"},[e._v("Tranche d'âge :")]),s("td",{staticClass:"tab-input"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.userInfos.ageRange,expression:"userInfos.ageRange"}],staticClass:"select",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.userInfos,"ageRange",t.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"",hidden:""}},[e._v("Sélectionner votre tranche d'âge")]),s("option",{attrs:{value:"10-20"}},[e._v("10 - 20 ans")]),s("option",{attrs:{value:"20-30"}},[e._v("20 - 30 ans")]),s("option",{attrs:{value:"30-40"}},[e._v("30 - 40 ans")]),s("option",{attrs:{value:"40-50"}},[e._v("40 - 50 ans")]),s("option",{attrs:{value:"50-60"}},[e._v("50 - 60 ans")]),s("option",{attrs:{value:"60-70"}},[e._v("60 - 70 ans")]),s("option",{attrs:{value:"70+"}},[e._v("70+ ans")])])])]),s("tr",[s("td",{staticStyle:{"padding-top":"10px"},attrs:{colspan:"2"}},[s("button",{staticClass:"button green large",on:{click:function(t){return e.updateProfil()}}},[e._v("Mettre mes informations à jour")])])])])])]),s("h2",[e._v("Modifier le mot de passe")]),s("div",{staticClass:"white-container"},[s("table",{staticClass:"user-panel-tab"},[s("tbody",[s("tr",[s("td",{staticClass:"tab-label"},[e._v("Mot de passe actuel :")]),s("td",{staticClass:"tab-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.currentPswd,expression:"currentPswd"}],staticClass:"input",class:["error"===e.currentPswdValid?"error":"","valid"===e.currentPswdValid?"valid":""],attrs:{type:"password"},domProps:{value:e.currentPswd},on:{input:function(t){t.target.composing||(e.currentPswd=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.currentPswdErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.currentPswdErrorMsg))])])]),s("tr",[s("td",{staticClass:"tab-label"},[e._v("Nouveau mot de passe :")]),s("td",{staticClass:"tab-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newPswd,expression:"newPswd"}],staticClass:"input",class:["error"===e.newPswdValid?"error":"","valid"===e.newPswdValid?"valid":""],attrs:{type:"password"},domProps:{value:e.newPswd},on:{input:function(t){t.target.composing||(e.newPswd=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.newPswdErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.newPswdErrorMsg))])])]),s("tr",[s("td",{staticClass:"tab-label"},[e._v("Confirmation du ouveau mot de passe :")]),s("td",{staticClass:"tab-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newPswdConfirm,expression:"newPswdConfirm"}],staticClass:"input",class:["error"===e.newPswdConfirmValid?"error":"","valid"===e.newPswdConfirmValid?"valid":""],attrs:{type:"password"},domProps:{value:e.newPswdConfirm},on:{input:function(t){t.target.composing||(e.newPswdConfirm=t.target.value)}}}),s("span",{staticClass:"error-field",class:[e.newPswdConfirmErrorMsg.length>0?"visible":"hidden"]},[e._v(e._s(e.newPswdConfirmErrorMsg))])])]),s("tr",[s("td",{staticStyle:{"padding-top":"10px"},attrs:{colspan:"2"}},[s("button",{staticClass:"button red large",on:{click:function(t){return e.updatePswd()}}},[e._v("Modifier le mot de passe")])])])])])])]),s("div",{staticClass:"col-5"},[s("h2",[e._v("Statistiques")]),s("div",{staticClass:"white-container"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col user-stats"},[s("h3",[e._v("Wake-words enregistrés")]),s("div",{staticClass:"stats-container"},[s("span",{staticClass:"icon talk"}),s("span",{staticClass:"number talk"},[e._v(e._s(e.userInfos.nbRecord))])]),s("a",{staticClass:"button red",attrs:{href:"/interface/record"}},[e._v("S'enregistrer")])]),s("div",{staticClass:"col user-stats"},[s("h3",[e._v("Wake-words écoutés")]),s("div",{staticClass:"stats-container"},[s("span",{staticClass:"icon listen"}),s("span",{staticClass:"number listen"},[e._v(e._s(e.userInfos.nbListen))])]),s("a",{staticClass:"button green",attrs:{href:"/interface/listen"}},[e._v("Écouter")])])])])])])])])])},Ie=[],Se={data:function(){return{userEmail:"",userEmailValid:!1,userEmailErrorMsg:"",lastNameValid:!1,lastNameErrorMsg:"",firstNameValid:!1,firstNameErrorMsg:"",currentPswd:"",currentPswdValid:!1,currentPswdErrorMsg:"",newPswd:"",newPswdValid:!1,newPswdErrorMsg:"",newPswdConfirm:"",newPswdConfirmValid:!1,newPswdConfirmErrorMsg:""}},computed:{userInfos:function(){return this.userEmail=this.$store.state.userInfos.email,this.$store.state.userInfos}},methods:{setMicrophone:function(e){this.userInfos.deviceType=e},validateEmail:function(e){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)},validateNames:function(e){return/^[a-zA-Z]+(([',. -][a-zA-Z ])?[a-zA-Z]*)*$/.test(e)},checkProfil:function(){var e=!0;return this.validateEmail(this.userEmail)?(this.userEmailValid="valid",this.userEmailErrorMsg=""):(e=!1,0===this.userInfos.email.length?(this.userEmailValid="error",this.userEmailErrorMsg="Veuillez renseigner une adresse email"):(this.userEmailValid="error",this.userEmailErrorMsg="Le format de l'adresse email est invalide")),this.validateNames(this.userInfos.lastName)||0===this.userInfos.lastName.length?(this.lastNameValid="valid",this.lastNameErrorMsg=""):(e=!1,this.lastNameValid="error",this.lastNameErrorMsg="Veuillez saisir un Nom valide"),this.validateNames(this.userInfos.firstName)||0===this.userInfos.firstName.length?(this.firstNameValid="valid",this.firstNameErrorMsg=""):(e=!1,this.firstNameValid="error",this.firstNameErrorMsg="Veuillez saisir un Prénom valide"),e},updateProfil:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t,s,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.checkProfil(),!t){e.next=10;break}return s=this.userInfos,s.email=this.userEmail,e.next=6,l()("".concat("http://localhost:3003","/api/user"),{method:"put",data:s});case 6:a=e.sent,"success"===a.data.status&&(this.userEmailValid=!1,this.lastNameValid=!1,this.firstNameValid=!1,Ue.$emit("notify_app",{status:"success",msg:"Vos informations ont été mises à jour",redirect:!1}),this.$store.dispatch("getUserInfos",this.userInfos.userHash)),e.next=11;break;case 10:return e.abrupt("return");case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),checkPswd:function(){var e=!0;return 0===this.currentPswd.length?(e=!1,this.currentPswdValid="error",this.currentPswdErrorMsg="Veuillez saisir votre mot de passe actuel"):(this.currentPswdValid="valid",this.currentPswdErrorMsg=""),0===this.newPswd.length?(e=!1,this.newPswdValid="error",this.newPswdErrorMsg="Veuillez saisir un nouveau mot de passe"):this.newPswd===this.currentPswd?(e=!1,this.newPswdValid="error",this.newPswdErrorMsg="Le nouveau mot de passe doit être différent de l'actuel"):this.newPswd.length<8?(e=!1,this.newPswdValid="error",this.newPswdErrorMsg="Votre mot de passe doit contenir au moins 8 caractères"):(this.newPswdValid="valid",this.newPswdErrorMsg=""),0===this.newPswdConfirm.length?(e=!1,this.newPswdConfirmValid="error",this.newPswdConfirmErrorMsg="Veuillez confirmer votre nouveau mot de passe"):this.newPswdConfirm!=this.newPswd?(e=!1,this.newPswdConfirmValid="error",this.newPswdConfirmErrorMsg="Les mots de passe saisis ne correspondent pas"):(this.newPswdConfirmValid="valid",this.newPswdConfirmErrorMsg=""),e},updatePswd:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t,s,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.checkPswd(),!t){e.next=9;break}return s={currentPswd:this.currentPswd,newPswd:this.newPswd,userHash:this.userInfos.userHash},e.next=5,l()("".concat("http://localhost:3003","/api/user/pswd"),{method:"put",data:s});case 5:a=e.sent,"success"===a.data.status?(Ue.$emit("notify_app",{status:"success",msg:"Votre mot de passe a été modifié",redirect:!1}),this.$store.dispatch("getUserInfos",this.userInfos.userHash)):"error"===a.data.status&&(0===a.data.code?(this.currentPswdValid="error",this.currentPswdErrorMsg="Le mot de passe saisi est invalide"):Ue.$emit("notify_app",{status:a.status,msg:a.data.msg,redirect:!1})),e.next=10;break;case 9:return e.abrupt("return");case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},$e=Se,Oe=Object(h["a"])($e,Ae,Ie,!1,null,null,null),ze=Oe.exports;a["a"].use(M["a"]);var Ne=new M["a"]({mode:"history",base:"/assets/",routes:[{path:"/",name:"home",component:B},{path:"/interface/account",name:"Compte utilisateur",component:ze},{path:"/interface/record",name:"Compte utilisateur",component:we},{path:"/interface/listen",name:"Compte utilisateur",component:Q},{path:"/interface/scenarios",name:"Ajouter des scenarios",component:xe},{path:"/interface/monitoring",name:"Monitoring",component:ne}]}),Le=s("2f62");s("3c43");a["a"].use(Le["a"]);var Te=new Le["a"].Store({strict:!1,state:{userInfos:"",scenarios:"",audios:""},mutations:{SET_USER:function(e,t){e.userInfos={email:t.email,gender:t.gender,deviceType:t.deviceType,firstName:t.firstName,lastName:t.lastName,ageRange:t.ageRange,nbListen:t.nbListen,nbRecord:t.nbRecord,userHash:t.userHash,recordList:t.recordList,role:t.role}},SET_SCENARIOS:function(e,t){e.scenarios=t},SET_AUDIOS:function(e,t){e.audios=t}},actions:{getUserInfos:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t,s){var a,r,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.commit,r=t.state,e.prev=1,e.next=4,l()("".concat("http://localhost:3003","/api/user/getInfos"),{method:"post",data:{hash:s}});case 4:return i=e.sent,a("SET_USER",i.data.user[0]),e.abrupt("return",r.userInfos);case 9:e.prev=9,e.t0=e["catch"](1),console.error(e.t0);case 12:case"end":return e.stop()}},e,null,[[1,9]])}));function t(t,s){return e.apply(this,arguments)}return t}(),getScenarios:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t){var s,a,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return s=t.commit,a=t.state,e.prev=1,e.next=4,l()("".concat("http://localhost:3003","/api/scenarios"),{method:"get"});case 4:return r=e.sent,s("SET_SCENARIOS",r.data.scenarios),e.abrupt("return",a.scenarios);case 9:e.prev=9,e.t0=e["catch"](1),console.error(e.t0);case 12:case"end":return e.stop()}},e,null,[[1,9]])}));function t(t){return e.apply(this,arguments)}return t}(),getAudios:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t){var s,a,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return s=t.commit,a=t.state,e.prev=1,e.next=4,l()("".concat("http://localhost:3003","/api/audios"),{method:"get"});case 4:return r=e.sent,r.data.audios,s("SET_AUDIOS",r.data.audios),e.abrupt("return",a.audios);case 10:e.prev=10,e.t0=e["catch"](1),console.error(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,10]])}));function t(t){return e.apply(this,arguments)}return t}()},getters:{AUDIO_BY_USER:function(e){return function(t){try{var s=e.audios;console.log("all audios",s);var a=[];return s.map(function(e){e.author!==t&&e.userVoted&&e.userVoted.indexOf(t)<0&&a.push(e)}),a}catch(err){console.error(err)}}},APP_STATS:function(e){var t=e.scenarios;if(t.length>0){var s=0,a=0;return t.map(function(e){s+=e.nbListen,a+=e.nbRecord}),{nbListen:s,nbRecord:a}}},GENDER_RATIO:function(e){var t=0,s=0,a=e.audios;a.map(function(e){"male"===e.gender?t+=1:"female"===e.gender&&(s+=1)});var r=t+s,i=100*t/r,n=100*s/r;return{total:r,pctMale:i,pctFemale:n}},DEVICES_RATIO:function(e){var t=e.audios,s=0,a=0,r=0;t.map(function(e){"default"===e.deviceType?s+=1:"casque"===e.deviceType?a+=1:"pied"===e.deviceType&&(r+=1)});var i=he()(s)+he()(a)+he()(r),n=100*s/i,o=100*a/i,c=100*r/i;return console.log("GETTER:",i,s,a,r),console.log("RESP:",n,c,o),{prctDefault:n,prctExternal:c,prctHeadphone:o}}}});s.d(t,"bus",function(){return Ue}),a["a"].config.productionTip=!1;var Ue=new a["a"];new a["a"]({router:Ne,store:Te,render:function(e){return e(P)}}).$mount("#app")},"94d4":function(e,t,s){"use strict";var a=s("2e93"),r=s.n(a);t["default"]=r.a},fd2d:function(e,t,s){"use strict";var a=s("43cb"),r=s("94d4"),i=s("2877"),n=Object(i["a"])(r["default"],a["a"],a["b"],!1,null,null,null);t["default"]=n.exports}});
//# sourceMappingURL=index.a1a15fa9.js.map